"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1572],{2534:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>h,default:()=>m,frontMatter:()=>l,metadata:()=>i,toc:()=>g});const i=JSON.parse('{"id":"state/index","title":"Overview","description":"Memories in Timbal enable AI systems to maintain context and track conversations across interactions. This guide explains how to implement and configure memory systems for your AI applications.","source":"@site/docs/state/index.md","sourceDirName":"state","slug":"/state/","permalink":"/state/","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Overview","sidebar":"docsSidebar"},"sidebar":"docsSidebar","previous":{"title":"Adding Memory","permalink":"/flows/memory"},"next":{"title":"Overview","permalink":"/integrations/"}}');var s=t(4848),r=t(8453),o=t(5495);const l={title:"Overview",sidebar:"docsSidebar"},h="Understanding Memories",a={},g=[{value:"What are Memories?",id:"what-are-memories",level:2},{value:"How Memories Work",id:"how-memories-work",level:2},{value:"Setting Up Memories",id:"setting-up-memories",level:2},{value:"Memory Configuration Options",id:"memory-configuration-options",level:2},{value:"State Savers",id:"state-savers",level:2},{value:"Memory Features",id:"memory-features",level:2}];function c(e){const n={h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"understanding-memories",children:"Understanding Memories"})}),"\n",(0,s.jsx)(n.p,{children:"Memories in Timbal enable AI systems to maintain context and track conversations across interactions. This guide explains how to implement and configure memory systems for your AI applications."}),"\n",(0,s.jsx)(n.h2,{id:"what-are-memories",children:"What are Memories?"}),"\n",(0,s.jsx)(n.p,{children:"Memories in Timbal provide persistent context management that:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Tracks conversation history"}),"\n",(0,s.jsx)(n.li,{children:"Maintains context between interactions"}),"\n",(0,s.jsx)(n.li,{children:"Enables natural conversation flow"}),"\n",(0,s.jsx)(n.li,{children:"Supports personalized AI experiences"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"how-memories-work",children:"How Memories Work"}),"\n",(0,s.jsx)(n.p,{children:"The memory system consists of two core components:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Message History"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Stores conversation history"}),"\n",(0,s.jsx)(n.li,{children:"Tracks tool usage and results"}),"\n",(0,s.jsx)(n.li,{children:"Maintains conversation flow"}),"\n",(0,s.jsx)(n.li,{children:"Preserves important context"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"State Management"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Saves memory between sessions"}),"\n",(0,s.jsx)(n.li,{children:"Manages memory window size"}),"\n",(0,s.jsx)(n.li,{children:"Handles memory persistence"}),"\n",(0,s.jsx)(n.li,{children:"Provides different storage options"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"setting-up-memories",children:"Setting Up Memories"}),"\n",(0,s.jsx)(n.p,{children:"To implement memory in your AI system you can do it as in Flow or Agents:"}),"\n",(0,s.jsx)(o.A,{language:"python",code:'from timbal import Flow\nfrom timbal.state.savers import InMemorySaver\n\n# Create a flow with memory\nflow = (\n    Flow()\n    .add_llm(\n        id="chat_llm",\n        memory_id="chat_llm",  # Enable memory\n        memory_window_size=30   # Remember last 30 messages\n  )\n)\n\n# Add state management\nflow.compile(state_saver=InMemorySaver())'}),"\n",(0,s.jsx)(o.A,{language:"python",code:'from timbal import Agent\nfrom timbal.state.savers import InMemorySaver\n\n# Create a flow with memory\nAgent(\n      model="gpt-4o-mini",\n      state_saver=InMemorySaver(),\n  )'}),"\n",(0,s.jsx)(n.h2,{id:"memory-configuration-options",children:"Memory Configuration Options"}),"\n",(0,s.jsx)(n.p,{children:"Configure memory according to your needs:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Shared Memory"})}),"\n",(0,s.jsx)(o.A,{language:"python",code:'# Both LLMs share the same memory\nflow = (\n    Flow()\n    .add_llm(id="llm1", memory_id="shared_memory")\n    .add_llm(id="llm2", memory_id="shared_memory")\n)'}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Limited Memory Window"})}),"\n",(0,s.jsx)(o.A,{language:"python",code:'flow.add_llm(\n     id="llm",\n     memory_id="llm",\n     memory_window_size=10  # Remember only last 10 messages\n)'}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"state-savers",children:"State Savers"}),"\n",(0,s.jsx)(n.p,{children:"Choose an appropriate state saver for your use case:"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"InMemorySaver"})}),"\n",(0,s.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"-4rem",margin:"0em 0"},children:[(0,s.jsx)("div",{style:{flex:1},children:(0,s.jsxs)("ul",{children:[(0,s.jsx)("li",{children:"Development and testing"}),(0,s.jsx)("li",{children:"RAM-based storage"}),(0,s.jsx)("li",{children:"Clears on program termination"})]})}),(0,s.jsx)("div",{style:{flex:1},children:(0,s.jsx)(o.A,{language:"python",code:"from timbal.state.savers import InMemorySaver\nstate_saver=InMemorySaver()"})})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"JSONLSaver"})}),"\n",(0,s.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"-4rem",margin:"0em 0"},children:[(0,s.jsx)("div",{style:{flex:1},children:(0,s.jsxs)("ul",{children:[(0,s.jsx)("li",{children:"File-based storage"}),(0,s.jsx)("li",{children:"Simple applications"}),(0,s.jsx)("li",{children:"Persists between restarts"})]})}),(0,s.jsx)("div",{style:{flex:1},children:(0,s.jsx)(o.A,{language:"python",code:'from timbal.state.savers import JSONLSaver\nstate_saver=JSONLSaver("memories.jsonl")'})})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"TimbalPlatformSaver"})}),"\n",(0,s.jsxs)("div",{style:{display:"flex",alignItems:"flex-start",gap:"-4rem",margin:"0em 0"},children:[(0,s.jsx)("div",{style:{flex:1},children:(0,s.jsxs)("ul",{children:[(0,s.jsx)("li",{children:"Production environment"}),(0,s.jsx)("li",{children:"Managed by Timbal Platform"}),(0,s.jsx)("li",{children:"Scalable and reliable"})]})}),(0,s.jsx)("div",{style:{flex:1},children:(0,s.jsx)(o.A,{language:"python",code:"from timbal.state.savers import TimbalPlatformSaver\nstate_saver=TimbalPlatformSaver()"})})]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"memory-features",children:"Memory Features"}),"\n",(0,s.jsx)(n.p,{children:"The memory system provides:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Context Preservation"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Maintains conversation flow"}),"\n",(0,s.jsx)(n.li,{children:"Tracks user preferences"}),"\n",(0,s.jsx)(n.li,{children:"Records previous decisions"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Window Management"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Controls memory size"}),"\n",(0,s.jsx)(n.li,{children:"Preserves important context"}),"\n",(0,s.jsx)(n.li,{children:"Optimizes performance"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Tool Context"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Records tool usage results"}),"\n",(0,s.jsx)(n.li,{children:"Maintains tool call context"}),"\n",(0,s.jsx)(n.li,{children:"Links related interactions"}),"\n"]}),"\n"]}),"\n"]})]})}function m(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},5495:(e,n,t)=>{t.d(n,{A:()=>g});var i=t(6540),s=t(1765),r=t(4848);(void 0!==t.g?t.g:window).Prism=s.My;const o={...s.Zj.github,plain:{...s.Zj.github.plain,backgroundColor:"#2d2d2d",color:"#ffffff"},styles:s.Zj.github.styles.map((e=>({...e,types:e.types})))},l={from:"custom-highlight-pink",import:"custom-highlight-pink","=":"custom-highlight-pink",timbal:"custom-highlight-green",Agent:"custom-highlight-green",steps:"custom-highlight-green",perplexity:"custom-highlight-green",InMemorySaver:"custom-highlight-green",fal:"custom-highlight-green",text_to_image:"custom-highlight-green",RunContext:"custom-highlight-green",twilio:"custom-highlight-green",whatsapp:"custom-highlight-green",model:"custom-highlight-orange",query:"custom-highlight-orange",context:"custom-highlight-orange",system_prompt:"custom-highlight-orange",tools:"custom-highlight-orange",parent_id:"custom-highlight-orange",id:"custom-highlight-orange",model_id:"custom-highlight-orange",to:"custom-highlight-orange",message:"custom-highlight-orange",resource:"custom-highlight-orange",max_results:"custom-highlight-orange",message_id:"custom-highlight-orange",thread_id:"custom-highlight-orange",subject:"custom-highlight-orange",body:"custom-highlight-orange",template_sid:"custom-highlight-orange",template_params:"custom-highlight-orange",scope:"custom-highlight-orange",folder:"custom-highlight-orange",destination:"custom-highlight-orange",text:"custom-highlight-orange",voice_id:"custom-highlight-orange",memory_id:"custom-highlight-orange",location:"custom-highlight-orange",memory_window_size:"custom-highlight-orange","(":"custom-highlight-yellow-dark",")":"custom-highlight-yellow-dark","[":"custom-highlight-purple-pink","]":"custom-highlight-purple-pink","{":"custom-highlight-yellow-dark","}":"custom-highlight-yellow-dark",",":"#fffff",Flow:"custom-highlight-green",await:"custom-highlight-pink",def:"custom-highlight-blue",async:"custom-highlight-blue","-":"#fffff",">":"#fffff",":":"#fffff",".":"#fffff",state:"custom-highlight-green",savers:"custom-highlight-green",sharepoint:"custom-highlight-green",Tool:"custom-highlight-green",list_directory:"custom-highlight-green-fn",gen_images:"custom-highlight-green-fn",download_file:"custom-highlight-green-fn",TimbalPlatformSaver:"custom-highlight-green",sql:"custom-highlight-green",postgres:"custom-highlight-green",return:"custom-highlight-pink",for:"custom-highlight-pink",in:"custom-highlight-pink",if:"custom-highlight-pink",datetime:"custom-highlight-green",elevenlabs:"custom-highlight-green",gmail:"custom-highlight-green",JSONLSaver:"custom-highlight-green",messages:"custom-highlight-green",types:"custom-highlight-green",File:"custom-highlight-green",postgres_query:"custom-highlight-green-fn",PGConfig:"custom-highlight-green",get_message:"custom-highlight-green-fn",get_thread:"custom-highlight-green-fn",get_datetime:"custom-highlight-green-fn",send_message:"custom-highlight-green-fn",run_sql_query:"custom-highlight-green-fn",create_draft_message:"custom-highlight-green-fn",send_whatsapp_message:"custom-highlight-green-fn",send_whatsapp_template:"custom-highlight-green-fn",validate:"custom-highlight-green-fn",complete:"custom-highlight-green-fn",print:"custom-highlight-green-fn",search:"custom-highlight-green-fn",search_internet:"custom-highlight-green-fn",stt:"custom-highlight-green-fn",tts:"custom-highlight-green-fn",run:"custom-highlight-green-fn",search_web:"custom-highlight-green-fn",set_input:"custom-highlight-green-fn",extract_text:"custom-highlight-green-fn",text_processor:"custom-highlight-green-fn",convert_to_database:"custom-highlight-green-fn",get_weather:"custom-highlight-green-fn",get_time:"custom-highlight-green-fn",add_step:"custom-highlight-green-fn",add_link:"custom-highlight-green-fn",set_output:"custom-highlight-green-fn",parse_documentation:"custom-highlight-green-fn",create_database:"custom-highlight-green-fn",add_llm:"custom-highlight-green-fn",compile:"custom-highlight-green-fn",str:"custom-highlight-green"},h=new RegExp(`(${Object.keys(l).map((e=>/^[a-zA-Z0-9_]+$/.test(e)?`\\b${e}\\b`:e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"))).join("|")})`,"g"),a=/"([^"]*)"/g;function g(e){const{title:n,children:t}=e,[g,c]=(0,i.useState)(!1);return(0,r.jsxs)("div",{className:"custom-codeblock-container",style:{borderRadius:"12px",overflow:"hidden",border:"1px solid #333",marginBottom:"1.5em",position:"relative"},children:[n&&(0,r.jsx)("div",{style:{background:"#2d2d2d",color:"#fff",padding:"0.3em 1em",fontSize:"0.85em",borderBottom:"1.5px solid #444",letterSpacing:"0.01em",display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,r.jsx)("span",{children:n})}),(0,r.jsx)(s.f4,{theme:o,...e,children:n=>{let{className:t,style:i,tokens:s,getLineProps:o,getTokenProps:m}=n;const d=s.map((e=>e.map((e=>e.content)).join(""))).join("\n");let u=0,p=0,f=0,x=0;s.forEach((e=>{e.forEach((e=>{const n=m({token:e}).children;"string"==typeof n&&"state_saver"===n.trim()&&p++,"string"==typeof n&&"audio_file"===n.trim()&&f++,"string"==typeof n&&"db_config"===n.trim()&&x++,"string"==typeof n&&"sql"===n.trim()&&0}))}));let j=0,y=0,v=0,w=0,b=[];const _=e=>{const n=(e-1)%3;return 0===n?"custom-highlight-yellow-dark":1===n?{color:"#ff69b4"}:{color:"#42a5f5"}};return(0,r.jsxs)("pre",{className:t,style:{...i,border:"none",borderRadius:0,color:"bash"===e.language?"#ffffff":i.color,margin:0,position:"relative"},children:[(0,r.jsx)("button",{className:"copy-icon-btn"+(g?" copied":""),onClick:()=>{navigator.clipboard.writeText(d),c(!0),setTimeout((()=>c(!1)),2e3)},"aria-label":"Copy code",type:"button",children:g?(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{fill:"#fff",d:"m9.55 15.15l8.475-8.475q.3-.3.7-.3t.7.3t.3.713t-.3.712l-9.175 9.2q-.3.3-.7.3t-.7-.3L4.55 13q-.3-.3-.288-.712t.313-.713t.713-.3t.712.3z"})}):(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",children:(0,r.jsxs)("g",{fill:"none",stroke:"#fff",strokeWidth:"1.5",children:[(0,r.jsx)("path",{d:"M6 11c0-2.828 0-4.243.879-5.121C7.757 5 9.172 5 12 5h3c2.828 0 4.243 0 5.121.879C21 6.757 21 8.172 21 11v5c0 2.828 0 4.243-.879 5.121C19.243 22 17.828 22 15 22h-3c-2.828 0-4.243 0-5.121-.879C6 20.243 6 18.828 6 16z"}),(0,r.jsx)("path",{d:"M6 19a3 3 0 0 1-3-3v-6c0-3.771 0-5.657 1.172-6.828S7.229 2 11 2h4a3 3 0 0 1 3 3"})]})})}),s.map(((n,t)=>{const i=n.map((e=>m({token:e}).children)).join("");return/^\s*#/.test(i)?(0,r.jsx)("div",{...o({line:n}),children:n.map(((n,t)=>{const i=m({token:n});return(0,r.jsx)("span",{className:(e.language,"custom-highlight-comment"),children:i.children},t)}))},t):(0,r.jsx)("div",{...o({line:n}),children:n.map(((n,t)=>{const i=m({token:n});let s=i.children;if("bash"===e.language)return(0,r.jsx)("span",{style:{color:"#ffffff"},children:s},t);const o=[];let g,c=0;for(;null!==(g=a.exec(s));){if(g.index>c){let e=s.slice(c,g.index).replace(h,(e=>`<span class="${l[e]}">${e}</span>`));e=e.replace(/\\b\\d+(?:\\.\\d+)?\\b/g,(e=>`<span class="custom-highlight-purple">${e}</span>`)),o.push(e)}o.push(`<span class="custom-highlight-yellow">${g[0]}</span>`),c=g.index+g[0].length}if(c<s.length){let e=s.slice(c).replace(h,(e=>`<span class="${l[e]}">${e}</span>`));e=e.replace(/\\b\\d+(?:\\.\\d+)?\\b/g,(e=>`<span class="custom-highlight-purple">${e}</span>`)),o.push(e)}const d=o.join("");if("string"==typeof s&&"prompt"===s.trim())return u++,1===u?(0,r.jsx)("span",{className:"custom-highlight-orange",children:s},t):2===u?(0,r.jsx)("span",{style:{color:"#fff"},children:s},t):(0,r.jsx)("span",{...i},t);if("string"==typeof s&&"audio_file"===s.trim())return y++,3===f&&2===y?(0,r.jsx)("span",{className:"custom-highlight-orange",children:s},t):(0,r.jsx)("span",{...i},t);if("string"==typeof s&&"state_saver"===s.trim())return j++,1===p&&1===j||2===p&&1===j||3===p&&2===j?(0,r.jsx)("span",{className:"custom-highlight-orange",children:s},t):(0,r.jsx)("span",{...i},t);if("string"==typeof s&&"db_config"===s.trim())return v++,1===x&&1===v||2===x&&1===v||3===x&&2===v?(0,r.jsx)("span",{className:"custom-highlight-orange",children:s},t):(0,r.jsx)("span",{...i},t);if("string"==typeof s&&"sql"===s.trim())return w++,1===w?(0,r.jsx)("span",{className:"custom-highlight-green",children:s},t):2===w||3===w?(0,r.jsx)("span",{className:"custom-highlight-orange",children:s},t):(0,r.jsx)("span",{...i},t);if("("===s||"{"===s||"["===s){b.push(s);const e=b.length,n=_(e);return"string"==typeof n?(0,r.jsx)("span",{className:n,children:s},t):(0,r.jsx)("span",{style:n,children:s},t)}if(")"===s||"}"===s||"]"===s){const e=b.length,n=_(e);let i;i="string"==typeof n?(0,r.jsx)("span",{className:n,children:s},t):(0,r.jsx)("span",{style:n,children:s},t);const o=b[b.length-1];return(")"===s&&"("===o||"}"===s&&"{"===o||"]"===s&&"["===o)&&b.pop(),i}return d!==s?(0,r.jsx)("span",{dangerouslySetInnerHTML:{__html:d}},t):(0,r.jsx)("span",{...i},t)}))},t)}))]})}})]})}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>l});var i=t(6540);const s={},r=i.createContext(s);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);