"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[6121],{1430:(e,n,t)=>{t.d(n,{W:()=>d});var s=t(6540),i=t(797);const a=["zero","one","two","few","many","other"];function l(e){return a.filter((n=>e.includes(n)))}const o={locale:"en",pluralForms:l(["one","other"]),select:e=>1===e?"one":"other"};function r(){const{i18n:{currentLocale:e}}=(0,i.A)();return(0,s.useMemo)((()=>{try{return function(e){const n=new Intl.PluralRules(e);return{locale:e,pluralForms:l(n.resolvedOptions().pluralCategories),select:e=>n.select(e)}}(e)}catch(n){return console.error(`Failed to use Intl.PluralRules for locale "${e}".\nDocusaurus will fallback to the default (English) implementation.\nError: ${n.message}\n`),o}}),[e])}function d(){const e=r();return{selectMessage:(n,t)=>function(e,n,t){const s=e.split("|");if(1===s.length)return s[0];s.length>t.pluralForms.length&&console.error(`For locale=${t.locale}, a maximum of ${t.pluralForms.length} plural forms are expected (${t.pluralForms.join(",")}), but the message contains ${s.length}: ${e}`);const i=t.select(n),a=t.pluralForms.indexOf(i);return s[Math.min(a,s.length-1)]}(t,n,e)}}},6530:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"concepts/index","title":"Overview","description":"Core Concept: Flows as DAGs","source":"@site/docs/concepts/index.md","sourceDirName":"concepts","slug":"/concepts/","permalink":"/docs/concepts/","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Overview","sidebar":"docsSidebar"}}');var i=t(4848),a=t(8453);t(9563);const l={title:"Overview",sidebar:"docsSidebar"},o="Building with Timbal",r={},d=[{value:"Core Concept: Flows as DAGs",id:"core-concept-flows-as-dags",level:2},{value:"What is a DAG?",id:"what-is-a-dag",level:2},{value:"Creating a Flow",id:"creating-a-flow",level:2},{value:"Builder Pattern",id:"builder-pattern",level:3},{value:"Adding Steps to Flow",id:"adding-steps-to-flow",level:2},{value:"Basic Step Addition",id:"basic-step-addition",level:3},{value:"Multiple Steps Challenge",id:"multiple-steps-challenge",level:3},{value:"Adding Links to Flow",id:"adding-links-to-flow",level:2},{value:"Basic Linking",id:"basic-linking",level:3},{value:"Setting Data",id:"setting-data",level:2},{value:"Savers",id:"savers",level:2},{value:"Running the Flow",id:"running-the-flow",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"building-with-timbal",children:"Building with Timbal"})}),"\n",(0,i.jsx)(n.h2,{id:"core-concept-flows-as-dags",children:"Core Concept: Flows as DAGs"}),"\n",(0,i.jsxs)(n.p,{children:["All the applications made with ",(0,i.jsx)(n.strong,{children:"Timbal"})," are execution ",(0,i.jsx)(n.strong,{children:"flows"})," that are represented as ",(0,i.jsx)(n.strong,{children:"directed acyclic graphs (DAGs)"}),". \ud83c\udfaf"]}),"\n",(0,i.jsx)(n.h2,{id:"what-is-a-dag",children:"What is a DAG?"}),"\n",(0,i.jsx)(n.p,{children:"A DAG is a directed graph that has no cycles."}),"\n",(0,i.jsx)(n.admonition,{title:"What is a Graph?",type:"note",children:(0,i.jsxs)(n.p,{children:["A graph is a way to show how things are connected.\nIt has dots (called ",(0,i.jsx)(n.strong,{children:"nodes"}),") and lines (called ",(0,i.jsx)(n.strong,{children:"edges"}),") that link them. Some lines have directions, and some don\u2019t.\nIf the line has an arrow, it means the direction of the connection. It can be a one-way or two-way connection.\nThe edges can show relationships, paths, or connections between the nodes."]})}),"\n",(0,i.jsxs)(n.p,{children:["In a DAG, each ",(0,i.jsx)(n.strong,{children:"node"})," represents a ",(0,i.jsx)(n.code,{children:"step"})," in the flow, and each ",(0,i.jsx)(n.strong,{children:"edge"})," represents a ",(0,i.jsx)(n.code,{children:"link"})," between two steps.\nNodes execute and edges mark the order of execution."]}),"\n",(0,i.jsx)("div",{align:"center",children:(0,i.jsx)("img",{src:"/img/dag_example.png",alt:"Alt text",style:{width:"70%"}})}),"\n",(0,i.jsx)(n.h2,{id:"creating-a-flow",children:"Creating a Flow"}),"\n",(0,i.jsxs)(n.p,{children:["First, you need to import the ",(0,i.jsx)(n.code,{children:"Flow"})," class:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from timbal import Flow\n"})}),"\n",(0,i.jsxs)(n.p,{children:["Create a new ",(0,i.jsx)(n.code,{children:"Flow"})," object with an optional identifier:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'flow_1 = Flow(id="my-flow")  # Custom ID\nflow_2 = Flow()              # Default ID: "flow"\n'})}),"\n",(0,i.jsx)(n.admonition,{title:"Why Use IDs? \ud83c\udff7\ufe0f",type:"tip",children:(0,i.jsx)(n.p,{children:"IDs are particularly useful when creating multiple flows that you want to compose together!"})}),"\n",(0,i.jsx)(n.h3,{id:"builder-pattern",children:"Builder Pattern"}),"\n",(0,i.jsx)(n.p,{children:"Timbal uses the builder pattern for creating clear and readable flows. Here are three equivalent approaches:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"# Method 1: Traditional method calls\nflow = Flow()\nflow.add_step()\nflow.add_step()\n\n# Method 2: Reassignment\nflow = Flow()\nflow = flow.add_step()\nflow = flow.add_step()\n\n# Method 3: Method chaining (recommended) \u2b50\nflow = (\n    Flow()\n    .add_step()\n    .add_step()\n)\n"})}),"\n",(0,i.jsxs)(n.admonition,{title:"Why Method Chaining?",type:"note",children:[(0,i.jsx)(n.p,{children:"The method chaining approach:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Makes flow structure more visible \ud83d\udc40"}),"\n",(0,i.jsx)(n.li,{children:"Reduces repetition \u267b\ufe0f"}),"\n",(0,i.jsx)(n.li,{children:"Keeps flow configuration in one cohesive block \ud83d\udce6"}),"\n"]})]}),"\n",(0,i.jsx)(n.p,{children:"Choose whichever style matches your preferences and coding standards!\ud83d\ude0a"}),"\n",(0,i.jsx)(n.p,{children:"Now that we have initialized our flow, we can start by adding methods."}),"\n",(0,i.jsx)(n.h2,{id:"adding-steps-to-flow",children:"Adding Steps to Flow"}),"\n",(0,i.jsx)(n.p,{children:"Let's explore how to add steps to your flow! \ud83d\ude80"}),"\n",(0,i.jsx)(n.h3,{id:"basic-step-addition",children:"Basic Step Addition"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"flow.add_step(handler)\n"})}),"\n",(0,i.jsx)(n.admonition,{title:"Simple, right? \u2728",type:"success",children:(0,i.jsx)(n.p,{children:"You've just added your first step!"})}),"\n",(0,i.jsx)(n.h3,{id:"multiple-steps-challenge",children:"Multiple Steps Challenge"}),"\n",(0,i.jsx)(n.p,{children:"But what about adding more steps?"}),"\n",(0,i.jsx)(n.p,{children:"If you try this:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"flow.add_step(handler)\nflow.add_step(handler) # \u26a0\ufe0f This will raise an error!\n"})}),"\n",(0,i.jsx)(n.admonition,{title:"Why Did This Fail? \ud83e\udd14",type:"warning",children:(0,i.jsxs)(n.p,{children:["This will raise an error because the step ",(0,i.jsx)(n.code,{children:"handler"})," already exists."]})}),"\n",(0,i.jsx)(n.p,{children:"But if we want two nodes to have the same function?"}),"\n",(0,i.jsxs)(n.admonition,{title:"Solution: Named Steps",type:"tip",children:[(0,i.jsx)(n.p,{children:"We can add a name to the step like this:"}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'flow.add_step("step_1", handler) # \u2705 Works!\nflow.add_step("step_2", handler) # \u2705 Works too!\n'})})]}),"\n",(0,i.jsx)(n.p,{children:"Now we have two steps with the same function."}),"\n",(0,i.jsx)(n.p,{children:"Fantastic! You know how to put a handler in the step. Let's go a little deeper."}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"What can be in a step?"})," \ud83d\udd0d\nA step can be any function! We can set up the functions like this:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'def handler(x: int = Field(description="The input to the handler")):\n    print(x)\n'})}),"\n",(0,i.jsxs)(n.p,{children:["See more about types of steps in the ",(0,i.jsx)(n.a,{href:"/docs/advanced/",children:"steps"})," section."]}),"\n",(0,i.jsx)(n.p,{children:"Now that you have seen how to set up the function. Imagine if you have 10 inputs and you want to pass them to the step.\nTired of setting data maps for multiple inputs? We've got you covered!"}),"\n",(0,i.jsxs)(n.admonition,{title:"Easy Input Setting \ud83c\udf1f",type:"tip",children:[(0,i.jsx)(n.p,{children:"You can set the inputs of the step as kwargs."}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'flow.add_step("step_1", handler, x=1, y=2)  # \ud83c\udfaf All inputs in one line!\n'})})]}),"\n",(0,i.jsx)(n.p,{children:"Now that you can add as many steps as you want, let's try to connect them."}),"\n",(0,i.jsx)(n.h2,{id:"adding-links-to-flow",children:"Adding Links to Flow"}),"\n",(0,i.jsx)(n.h3,{id:"basic-linking",children:"Basic Linking"}),"\n",(0,i.jsx)(n.p,{children:"Connect two steps like this:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'flow = (\n    Flow()\n    .add_step("step_1", handler)\n    .add_step("step_2", handler)\n    .add_link("step_1", "step_2") # Creates connection\n)\n'})}),"\n",(0,i.jsx)(n.p,{children:"You did it! Now we have a flow with two steps and a link between them."}),"\n",(0,i.jsx)("div",{align:"center",children:(0,i.jsx)("img",{src:"/img/dag_link.png",alt:"Alt text",style:{width:"50%"}})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsxs)(n.em,{children:["See more properties in the advanced ",(0,i.jsx)(n.a,{href:"/docs/advanced/link",children:"links"})," section."]})}),"\n",(0,i.jsx)(n.p,{children:"But what about the data?... How we can set the input for each step?"}),"\n",(0,i.jsx)(n.p,{children:"That's easy! Let's take a look at it:"}),"\n",(0,i.jsx)(n.h2,{id:"setting-data",children:"Setting Data"}),"\n",(0,i.jsxs)(n.p,{children:["Our function ",(0,i.jsx)(n.em,{children:"handler"})," has an input ",(0,i.jsx)(n.em,{children:"x"})," that is an integer. We can set the input of the step like this:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:"{4}",children:'flow = (\n    Flow()\n    .add_step("step_1", handler)\n    .set_data_value("step_1.x", 1) # Sets input x=1\n)\n'})}),"\n",(0,i.jsx)(n.p,{children:"And the outputs?"}),"\n",(0,i.jsxs)(n.p,{children:["Each output will be the ",(0,i.jsx)(n.code,{children:"return"})," of the step. But we can map the output to the specific name we want to use."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'flow.set_output("result", "step_1.return")\n'})}),"\n",(0,i.jsx)(n.p,{children:"And if we have two steps, how can we set the input of the second step as the output of the first step?"}),"\n",(0,i.jsx)(n.p,{children:"We only have to apply the 2 things explained before:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",metastring:"{6}",children:'flow = (\n    Flow()\n    .add_step("step_1", handler, x=1)\n    .add_step("step_2", handler)\n    .add_link("step_1", "step_2") # Link the steps\n    .set_data_map("step_2.x", "step_1.return") # Set input of step 2 as the output of step 1\n)\n'})}),"\n",(0,i.jsx)(n.p,{children:"And if we want each step return to be the input of the next step? We have to link all the steps...\nIt is redudant!"}),"\n",(0,i.jsxs)(n.admonition,{title:"Smart Linking! \ud83c\udf1f",type:"tip",children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"set_data_map"})," and ",(0,i.jsx)(n.code,{children:"set_data_value"})," are smart! They automatically create links between steps when needed. This means you can write:"]}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:'flow = (\n    Flow()\n    .add_step("step_1", handler, x=1)\n    .add_step("step_2", handler)\n    .set_data_map("step_2.x", "step_1.return")  # Link created automatically!\n)\n'})})]}),"\n",(0,i.jsx)(n.h2,{id:"savers",children:"Savers"}),"\n",(0,i.jsxs)(n.p,{children:["Save your flow's state. From Timbal, we provide you a simple saver that saves the flow's state in memory: ",(0,i.jsx)(n.code,{children:"InMemorySaver"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"from timbal.state.savers import InMemorySaver\n\nflow.compile(state_saver=InMemorySaver())\n"})}),"\n",(0,i.jsxs)(n.p,{children:["You only need to set the ",(0,i.jsx)(n.code,{children:"state_saver"})," when you compile the flow.\n",(0,i.jsxs)(n.em,{children:["See more about it in the ",(0,i.jsx)(n.a,{href:"/docs/guides/saver",children:"saver"})," section."]})]}),"\n",(0,i.jsx)(n.p,{children:"But we don't forget the most important part: how can we obtain the result of the flow?"}),"\n",(0,i.jsx)(n.h2,{id:"running-the-flow",children:"Running the Flow"}),"\n",(0,i.jsxs)(n.p,{children:["To run the flow, we can use the ",(0,i.jsx)(n.code,{children:"run()"})," method."]}),"\n",(0,i.jsx)(n.p,{children:"Get detailed execution events:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"async for event in flow.run():\n    print(event) \n"})}),"\n",(0,i.jsx)(n.admonition,{title:"Running the Flow",type:"note",children:(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.code,{children:"run()"})," method returns an async iterator that yields events as the flow executes."]})}),"\n",(0,i.jsx)(n.p,{children:"Or if it does not matter the specific event. Get the final result directly:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-python",children:"result = await flow.complete()\n"})}),"\n",(0,i.jsx)(n.p,{children:"Okay! Now you now the basics of Timbal."})]})}function h(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>l,x:()=>o});var s=t(6540);const i={},a=s.createContext(i);function l(e){const n=s.useContext(a);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),s.createElement(a.Provider,{value:n},e.children)}},9563:(e,n,t)=>{t.d(n,{A:()=>j});t(6540);var s=t(4164),i=t(3751),a=t(6289),l=t(1430),o=t(2887),r=t(539),d=t(9303);const c={cardContainer:"cardContainer_fWXF",cardTitle:"cardTitle_rnsV",cardDescription:"cardDescription_PWke"};var h=t(4848);function p(e){let{href:n,children:t}=e;return(0,h.jsx)(a.A,{href:n,className:(0,s.A)("card padding--lg",c.cardContainer),children:t})}function u(e){let{href:n,icon:t,title:i,description:a}=e;return(0,h.jsxs)(p,{href:n,children:[(0,h.jsxs)(d.A,{as:"h2",className:(0,s.A)("text--truncate",c.cardTitle),title:i,children:[t," ",i]}),a&&(0,h.jsx)("p",{className:(0,s.A)("text--truncate",c.cardDescription),title:a,children:a})]})}function x(e){let{item:n}=e;const t=(0,i.Nr)(n),s=function(){const{selectMessage:e}=(0,l.W)();return n=>e(n,(0,r.T)({message:"1 item|{count} items",id:"theme.docs.DocCard.categoryDescription.plurals",description:"The default description for a category card in the generated index about how many items this category includes"},{count:n}))}();return t?(0,h.jsx)(u,{href:t,icon:"\ud83d\uddc3\ufe0f",title:n.label,description:n.description??s(n.items.length)}):null}function m(e){let{item:n}=e;const t=(0,o.A)(n.href)?"\ud83d\udcc4\ufe0f":"\ud83d\udd17",s=(0,i.cC)(n.docId??void 0);return(0,h.jsx)(u,{href:n.href,icon:t,title:n.label,description:n.description??s?.description})}function w(e){let{item:n}=e;switch(n.type){case"link":return(0,h.jsx)(m,{item:n});case"category":return(0,h.jsx)(x,{item:n});default:throw new Error(`unknown item type ${JSON.stringify(n)}`)}}function f(e){let{className:n}=e;const t=(0,i.$S)();return(0,h.jsx)(j,{items:t.items,className:n})}function j(e){const{items:n,className:t}=e;if(!n)return(0,h.jsx)(f,{...e});const a=(0,i.d1)(n);return(0,h.jsx)("section",{className:(0,s.A)("row",t),children:a.map(((e,n)=>(0,h.jsx)("article",{className:"col col--6 margin-bottom--lg",children:(0,h.jsx)(w,{item:e})},n)))})}}}]);