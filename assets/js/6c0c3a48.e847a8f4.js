"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[1901],{306:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>m,frontMatter:()=>h,metadata:()=>n,toc:()=>d});const n=JSON.parse('{"id":"integrations/sharepoint","title":"SharePoint","description":"Timbal integrates with SharePoint to enable listing, downloading, and managing files programmatically. This integration allows you to access both personal and shared files across different scopes in your SharePoint environment.","source":"@site/docs/integrations/sharepoint.md","sourceDirName":"integrations","slug":"/integrations/sharepoint","permalink":"/integrations/sharepoint","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"SharePoint","sidebar":"docsSidebar"},"sidebar":"docsSidebar","previous":{"title":"Gmail","permalink":"/integrations/gmail"},"next":{"title":"Fal","permalink":"/integrations/fal"}}');var s=i(4848),r=i(8453),l=i(5495),o=i(9593);const h={title:"SharePoint",sidebar:"docsSidebar"},a="SharePoint Integration",c={},d=[{value:"Prerequisites",id:"prerequisites",level:2},{value:"Authentication Setup",id:"authentication-setup",level:2},{value:"Installation",id:"installation",level:2},{value:"<span><strong>List Directory</strong></span>",id:"list-directory",level:2},{value:"Description",id:"description",level:3},{value:"Example",id:"example",level:3},{value:"Parameters",id:"parameters",level:3},{value:"<span><strong>Download File</strong></span>",id:"download-file",level:2},{value:"Description",id:"description-1",level:3},{value:"Example",id:"example-1",level:3},{value:"Parameters",id:"parameters-1",level:3},{value:"Agent Integration Example",id:"agent-integration-example",level:2},{value:"Notes",id:"notes",level:2}];function g(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"sharepoint-integration",children:"SharePoint Integration"})}),"\n",(0,s.jsx)(t.p,{children:"Timbal integrates with SharePoint to enable listing, downloading, and managing files programmatically. This integration allows you to access both personal and shared files across different scopes in your SharePoint environment."}),"\n",(0,s.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsx)(t.p,{children:"Before using the SharePoint integration, you'll need:"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:["A ",(0,s.jsx)(t.a,{href:"https://portal.azure.com/#view/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/~/Overview",children:"Microsoft 365 tenant"})]}),"\n",(0,s.jsxs)(t.li,{children:["A registered application in ",(0,s.jsx)(t.a,{href:"https://portal.azure.com/#view/Microsoft_AAD_IAM/ActiveDirectoryMenuBlade/~/RegisteredApps",children:"Azure Portal"})," with:","\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Application (client) ID"}),"\n",(0,s.jsx)(t.li,{children:"Directory (tenant) ID"}),"\n",(0,s.jsx)(t.li,{children:"Client secret"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["Required permissions configured:","\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Files.Read.All"}),"\n",(0,s.jsx)(t.li,{children:"Sites.Read.All"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:["A ",(0,s.jsx)(t.code,{children:"token_sharepoint.json"})," file with your credentials"]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"authentication-setup",children:"Authentication Setup"}),"\n",(0,s.jsx)(t.p,{children:"The first time you use the integration, you'll be prompted to authenticate:"}),"\n",(0,s.jsx)(l.A,{language:"bash",code:"uv run authenticate.py"}),"\n",(0,s.jsx)(t.p,{children:"This will open a browser window for Microsoft sign-in and create a token file for future use."}),"\n",(0,s.jsx)(t.h2,{id:"installation",children:"Installation"}),"\n",(0,s.jsx)(t.p,{children:"Install the requirements by doing:"}),"\n",(0,s.jsx)(l.A,{language:"bash",code:"uv add timbal[steps-sharepoint]"}),"\n",(0,s.jsx)(t.h2,{id:"list-directory",children:(0,s.jsx)("span",{style:{color:"var(--timbal-purple)"},children:(0,s.jsx)("strong",{children:"List Directory"})})}),"\n",(0,s.jsx)(t.h3,{id:"description",children:"Description"}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.strong,{children:"list_directory"})," step allows you to list files and folders in SharePoint, with support for both personal and shared files across different scopes."]}),"\n",(0,s.jsx)(t.h3,{id:"example",children:"Example"}),"\n",(0,s.jsx)(l.A,{language:"python",code:'from timbal.steps.sharepoint.directories import list_directory\n\n# List all files in personal drive\nitems = await list_directory(scope="my-files")\n\n# List contents of a specific folder\nfolder_items = await list_directory(\n  folder="Projects/2024",\n  scope="my-files"\n)\n\n# List shared files\nshared_items = await list_directory(scope="shared")'}),"\n",(0,s.jsx)(t.h3,{id:"parameters",children:"Parameters"}),"\n",(0,s.jsxs)(o.A,{className:"wider-table",children:[(0,s.jsxs)("colgroup",{children:[(0,s.jsx)("col",{style:{width:"15%"}}),(0,s.jsx)("col",{style:{width:"10%"}}),(0,s.jsx)("col",{style:{width:"60%"}}),(0,s.jsx)("col",{style:{width:"15%"}})]}),(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Parameter"}),(0,s.jsx)("th",{children:"Type"}),(0,s.jsx)("th",{children:"Description"}),(0,s.jsx)("th",{children:"Required"})]})}),(0,s.jsxs)("tbody",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)("code",{children:"folder"})}),(0,s.jsx)("td",{children:(0,s.jsx)("code",{children:"str"})}),(0,s.jsx)("td",{children:"The SharePoint folder path to list contents from"}),(0,s.jsx)("td",{children:"No"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)("code",{children:"scope"})}),(0,s.jsx)("td",{children:(0,s.jsx)("code",{children:"str"})}),(0,s.jsx)("td",{children:"Where to search for files: 'my-files', 'shared', or 'all'"}),(0,s.jsx)("td",{children:"No"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)("code",{children:"output_path"})}),(0,s.jsx)("td",{children:(0,s.jsx)("code",{children:"str"})}),(0,s.jsx)("td",{children:"Path to save the output JSON file"}),(0,s.jsx)("td",{children:"No"})]})]})]}),"\n",(0,s.jsx)(t.h2,{id:"download-file",children:(0,s.jsx)("span",{style:{color:"var(--timbal-purple)"},children:(0,s.jsx)("strong",{children:"Download File"})})}),"\n",(0,s.jsx)(t.h3,{id:"description-1",children:"Description"}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.strong,{children:"download_file"})," step allows you to download files from SharePoint by searching for them across different scopes."]}),"\n",(0,s.jsx)(t.h3,{id:"example-1",children:"Example"}),"\n",(0,s.jsx)(l.A,{language:"python",code:'from timbal.steps.sharepoint.files import download_file\n\n# Download a file from personal drive\nsuccess = await download_file("document.docx")\n\n# Download from a specific folder\nsuccess = await download_file(\n  "report.pdf",\n  folder="Projects/2024"\n)\n\n# Download from shared files\nsuccess = await download_file(\n  "presentation.pptx",\n  scope="shared"\n)\n\n# Download to specific location\nsuccess = await download_file(\n  "data.xlsx",\n  destination="/path/to/save"\n)'}),"\n",(0,s.jsx)(t.h3,{id:"parameters-1",children:"Parameters"}),"\n",(0,s.jsxs)(o.A,{className:"wider-table",children:[(0,s.jsxs)("colgroup",{children:[(0,s.jsx)("col",{style:{width:"15%"}}),(0,s.jsx)("col",{style:{width:"10%"}}),(0,s.jsx)("col",{style:{width:"60%"}}),(0,s.jsx)("col",{style:{width:"15%"}})]}),(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"Parameter"}),(0,s.jsx)("th",{children:"Type"}),(0,s.jsx)("th",{children:"Description"}),(0,s.jsx)("th",{children:"Required"})]})}),(0,s.jsxs)("tbody",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)("code",{children:"file"})}),(0,s.jsx)("td",{children:(0,s.jsx)("code",{children:"str"})}),(0,s.jsx)("td",{children:"Name or ID of the file to find and download"}),(0,s.jsx)("td",{children:"Yes"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)("code",{children:"destination"})}),(0,s.jsx)("td",{children:(0,s.jsx)("code",{children:"str"})}),(0,s.jsx)("td",{children:"Directory where the file will be downloaded to. If None, uses the current working directory"}),(0,s.jsx)("td",{children:"No"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)("code",{children:"folder"})}),(0,s.jsx)("td",{children:(0,s.jsx)("code",{children:"str"})}),(0,s.jsx)("td",{children:"Optional path to a specific folder to search in"}),(0,s.jsx)("td",{children:"No"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:(0,s.jsx)("code",{children:"scope"})}),(0,s.jsx)("td",{children:(0,s.jsx)("code",{children:"str"})}),(0,s.jsx)("td",{children:"Search scope ('my-files', 'shared', or 'all'). Defaults to 'my-files'"}),(0,s.jsx)("td",{children:"No"})]})]})]}),"\n",(0,s.jsx)(t.h2,{id:"agent-integration-example",children:"Agent Integration Example"}),"\n",(0,s.jsx)(l.A,{language:"python",code:'from timbal.steps.sharepoint.directories import list_directory\nfrom timbal import Agent\n\nagent = Agent(\n  tools=[list_directory]\n)\n\nresponse = await agent.complete(\n  prompt={\n      "folder": "Projects/2024",\n      "scope": "my-files"\n  }\n)'}),"\n",(0,s.jsx)(t.h2,{id:"notes",children:"Notes"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Make sure your Microsoft 365 tenant and app registration are properly configured"}),"\n",(0,s.jsx)(t.li,{children:"The first authentication will prompt a browser sign-in and create a token file for future use"}),"\n",(0,s.jsx)(t.li,{children:"File names are case-sensitive"}),"\n",(0,s.jsx)(t.li,{children:"If multiple files with the same name exist, an error will be raised"}),"\n",(0,s.jsx)(t.li,{children:"Ensure you have the necessary permissions to access the files"}),"\n",(0,s.jsxs)(t.li,{children:["For more advanced usage, see the ",(0,s.jsx)(t.a,{href:"https://learn.microsoft.com/en-us/graph/overview",children:"Microsoft Graph API documentation"})]}),"\n"]})]})}function m(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(g,{...e})}):g(e)}},5495:(e,t,i)=>{i.d(t,{A:()=>c});var n=i(6540),s=i(1765),r=i(4848);(void 0!==i.g?i.g:window).Prism=s.My;const l={...s.Zj.github,plain:{...s.Zj.github.plain,backgroundColor:"#2d2d2d",color:"#ffffff"},styles:s.Zj.github.styles.map((e=>({...e,types:e.types})))},o={from:"custom-highlight-pink",import:"custom-highlight-pink","=":"custom-highlight-pink",timbal:"custom-highlight-green",Agent:"custom-highlight-green",steps:"custom-highlight-green",perplexity:"custom-highlight-green",InMemorySaver:"custom-highlight-green",fal:"custom-highlight-green",text_to_image:"custom-highlight-green",RunContext:"custom-highlight-green",twilio:"custom-highlight-green",whatsapp:"custom-highlight-green",model:"custom-highlight-orange",query:"custom-highlight-orange",context:"custom-highlight-orange",system_prompt:"custom-highlight-orange",tools:"custom-highlight-orange",parent_id:"custom-highlight-orange",id:"custom-highlight-orange",model_id:"custom-highlight-orange",to:"custom-highlight-orange",message:"custom-highlight-orange",resource:"custom-highlight-orange",max_results:"custom-highlight-orange",message_id:"custom-highlight-orange",thread_id:"custom-highlight-orange",subject:"custom-highlight-orange",body:"custom-highlight-orange",template_sid:"custom-highlight-orange",template_params:"custom-highlight-orange",scope:"custom-highlight-orange",folder:"custom-highlight-orange",destination:"custom-highlight-orange",text:"custom-highlight-orange",voice_id:"custom-highlight-orange",memory_id:"custom-highlight-orange",location:"custom-highlight-orange",memory_window_size:"custom-highlight-orange","(":"custom-highlight-yellow-dark",")":"custom-highlight-yellow-dark","[":"custom-highlight-purple-pink","]":"custom-highlight-purple-pink","{":"custom-highlight-yellow-dark","}":"custom-highlight-yellow-dark",",":"#fffff",Flow:"custom-highlight-green",await:"custom-highlight-pink",def:"custom-highlight-blue",async:"custom-highlight-blue","-":"#fffff",">":"#fffff",":":"#fffff",".":"#fffff",state:"custom-highlight-green",savers:"custom-highlight-green",sharepoint:"custom-highlight-green",Tool:"custom-highlight-green",list_directory:"custom-highlight-green-fn",gen_images:"custom-highlight-green-fn",download_file:"custom-highlight-green-fn",TimbalPlatformSaver:"custom-highlight-green",sql:"custom-highlight-green",postgres:"custom-highlight-green",return:"custom-highlight-pink",for:"custom-highlight-pink",in:"custom-highlight-pink",if:"custom-highlight-pink",datetime:"custom-highlight-green",elevenlabs:"custom-highlight-green",gmail:"custom-highlight-green",JSONLSaver:"custom-highlight-green",messages:"custom-highlight-green",types:"custom-highlight-green",File:"custom-highlight-green",postgres_query:"custom-highlight-green-fn",PGConfig:"custom-highlight-green",get_message:"custom-highlight-green-fn",get_thread:"custom-highlight-green-fn",get_datetime:"custom-highlight-green-fn",send_message:"custom-highlight-green-fn",run_sql_query:"custom-highlight-green-fn",create_draft_message:"custom-highlight-green-fn",send_whatsapp_message:"custom-highlight-green-fn",send_whatsapp_template:"custom-highlight-green-fn",validate:"custom-highlight-green-fn",complete:"custom-highlight-green-fn",print:"custom-highlight-green-fn",search:"custom-highlight-green-fn",search_internet:"custom-highlight-green-fn",stt:"custom-highlight-green-fn",tts:"custom-highlight-green-fn",run:"custom-highlight-green-fn",search_web:"custom-highlight-green-fn",set_input:"custom-highlight-green-fn",extract_text:"custom-highlight-green-fn",text_processor:"custom-highlight-green-fn",convert_to_database:"custom-highlight-green-fn",get_weather:"custom-highlight-green-fn",get_time:"custom-highlight-green-fn",add_step:"custom-highlight-green-fn",add_link:"custom-highlight-green-fn",set_output:"custom-highlight-green-fn",parse_documentation:"custom-highlight-green-fn",create_database:"custom-highlight-green-fn",add_llm:"custom-highlight-green-fn",compile:"custom-highlight-green-fn",str:"custom-highlight-green"},h=new RegExp(`(${Object.keys(o).map((e=>/^[a-zA-Z0-9_]+$/.test(e)?`\\b${e}\\b`:e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"))).join("|")})`,"g"),a=/"([^"]*)"/g;function c(e){const{title:t,children:i}=e,[c,d]=(0,n.useState)(!1);return(0,r.jsxs)("div",{className:"custom-codeblock-container",style:{borderRadius:"12px",overflow:"hidden",border:"1px solid #333",marginBottom:"1.5em",position:"relative"},children:[t&&(0,r.jsx)("div",{style:{background:"#2d2d2d",color:"#fff",padding:"0.3em 1em",fontSize:"0.85em",borderBottom:"1.5px solid #444",letterSpacing:"0.01em",display:"flex",justifyContent:"space-between",alignItems:"center"},children:(0,r.jsx)("span",{children:t})}),(0,r.jsx)(s.f4,{theme:l,...e,children:t=>{let{className:i,style:n,tokens:s,getLineProps:l,getTokenProps:g}=t;const m=s.map((e=>e.map((e=>e.content)).join(""))).join("\n");let p=0,u=0,f=0,x=0;s.forEach((e=>{e.forEach((e=>{const t=g({token:e}).children;"string"==typeof t&&"state_saver"===t.trim()&&u++,"string"==typeof t&&"audio_file"===t.trim()&&f++,"string"==typeof t&&"db_config"===t.trim()&&x++,"string"==typeof t&&"sql"===t.trim()&&0}))}));let j=0,y=0,w=0,v=0,b=[];const _=e=>{const t=(e-1)%3;return 0===t?"custom-highlight-yellow-dark":1===t?{color:"#ff69b4"}:{color:"#42a5f5"}};return(0,r.jsxs)("pre",{className:i,style:{...n,border:"none",borderRadius:0,color:"bash"===e.language?"#ffffff":n.color,margin:0,position:"relative"},children:[(0,r.jsx)("button",{className:"copy-icon-btn"+(c?" copied":""),onClick:()=>{navigator.clipboard.writeText(m),d(!0),setTimeout((()=>d(!1)),2e3)},"aria-label":"Copy code",type:"button",children:c?(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{fill:"#fff",d:"m9.55 15.15l8.475-8.475q.3-.3.7-.3t.7.3t.3.713t-.3.712l-9.175 9.2q-.3.3-.7.3t-.7-.3L4.55 13q-.3-.3-.288-.712t.313-.713t.713-.3t.712.3z"})}):(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24",children:(0,r.jsxs)("g",{fill:"none",stroke:"#fff",strokeWidth:"1.5",children:[(0,r.jsx)("path",{d:"M6 11c0-2.828 0-4.243.879-5.121C7.757 5 9.172 5 12 5h3c2.828 0 4.243 0 5.121.879C21 6.757 21 8.172 21 11v5c0 2.828 0 4.243-.879 5.121C19.243 22 17.828 22 15 22h-3c-2.828 0-4.243 0-5.121-.879C6 20.243 6 18.828 6 16z"}),(0,r.jsx)("path",{d:"M6 19a3 3 0 0 1-3-3v-6c0-3.771 0-5.657 1.172-6.828S7.229 2 11 2h4a3 3 0 0 1 3 3"})]})})}),s.map(((t,i)=>{const n=t.map((e=>g({token:e}).children)).join("");return/^\s*#/.test(n)?(0,r.jsx)("div",{...l({line:t}),children:t.map(((t,i)=>{const n=g({token:t});return(0,r.jsx)("span",{className:(e.language,"custom-highlight-comment"),children:n.children},i)}))},i):(0,r.jsx)("div",{...l({line:t}),children:t.map(((t,i)=>{const n=g({token:t});let s=n.children;if("bash"===e.language)return(0,r.jsx)("span",{style:{color:"#ffffff"},children:s},i);const l=[];let c,d=0;for(;null!==(c=a.exec(s));){if(c.index>d){let e=s.slice(d,c.index).replace(h,(e=>`<span class="${o[e]}">${e}</span>`));e=e.replace(/\\b\\d+(?:\\.\\d+)?\\b/g,(e=>`<span class="custom-highlight-purple">${e}</span>`)),l.push(e)}l.push(`<span class="custom-highlight-yellow">${c[0]}</span>`),d=c.index+c[0].length}if(d<s.length){let e=s.slice(d).replace(h,(e=>`<span class="${o[e]}">${e}</span>`));e=e.replace(/\\b\\d+(?:\\.\\d+)?\\b/g,(e=>`<span class="custom-highlight-purple">${e}</span>`)),l.push(e)}const m=l.join("");if("string"==typeof s&&"prompt"===s.trim())return p++,1===p?(0,r.jsx)("span",{className:"custom-highlight-orange",children:s},i):2===p?(0,r.jsx)("span",{style:{color:"#fff"},children:s},i):(0,r.jsx)("span",{...n},i);if("string"==typeof s&&"audio_file"===s.trim())return y++,3===f&&2===y?(0,r.jsx)("span",{className:"custom-highlight-orange",children:s},i):(0,r.jsx)("span",{...n},i);if("string"==typeof s&&"state_saver"===s.trim())return j++,1===u&&1===j||2===u&&1===j||3===u&&2===j?(0,r.jsx)("span",{className:"custom-highlight-orange",children:s},i):(0,r.jsx)("span",{...n},i);if("string"==typeof s&&"db_config"===s.trim())return w++,1===x&&1===w||2===x&&1===w||3===x&&2===w?(0,r.jsx)("span",{className:"custom-highlight-orange",children:s},i):(0,r.jsx)("span",{...n},i);if("string"==typeof s&&"sql"===s.trim())return v++,1===v?(0,r.jsx)("span",{className:"custom-highlight-green",children:s},i):2===v||3===v?(0,r.jsx)("span",{className:"custom-highlight-orange",children:s},i):(0,r.jsx)("span",{...n},i);if("("===s||"{"===s||"["===s){b.push(s);const e=b.length,t=_(e);return"string"==typeof t?(0,r.jsx)("span",{className:t,children:s},i):(0,r.jsx)("span",{style:t,children:s},i)}if(")"===s||"}"===s||"]"===s){const e=b.length,t=_(e);let n;n="string"==typeof t?(0,r.jsx)("span",{className:t,children:s},i):(0,r.jsx)("span",{style:t,children:s},i);const l=b[b.length-1];return(")"===s&&"("===l||"}"===s&&"{"===l||"]"===s&&"["===l)&&b.pop(),n}return m!==s?(0,r.jsx)("span",{dangerouslySetInnerHTML:{__html:m}},i):(0,r.jsx)("span",{...n},i)}))},i)}))]})}})]})}},8453:(e,t,i)=>{i.d(t,{R:()=>l,x:()=>o});var n=i(6540);const s={},r=n.createContext(s);function l(e){const t=n.useContext(r);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),n.createElement(r.Provider,{value:t},e.children)}},9593:(e,t,i)=>{i.d(t,{A:()=>s});i(6540);var n=i(4848);function s(e){let{children:t,className:i}=e;return(0,n.jsx)("table",{className:i,style:{width:"100%"},children:t})}}}]);