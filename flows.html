<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-flows/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Overview | Timbal AI</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://docs.timbal.ai/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://docs.timbal.ai/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://docs.timbal.ai/flows"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Overview | Timbal AI"><meta data-rh="true" name="description" content="Design, connect, and control multi-step AI pipelines using Flows—Timbal&#x27;s flexible workflow engine."><meta data-rh="true" property="og:description" content="Design, connect, and control multi-step AI pipelines using Flows—Timbal&#x27;s flexible workflow engine."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.timbal.ai/flows"><link data-rh="true" rel="alternate" href="https://docs.timbal.ai/flows" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.timbal.ai/flows" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.99d34304.css">
<script src="/assets/js/runtime~main.ce7e98ea.js" defer="defer"></script>
<script src="/assets/js/main.7a48833e.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/LogoBlack.svg"><link rel="preload" as="image" href="/img/LogoWhite.svg"><link rel="preload" as="image" href="/img/dag_link.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/LogoBlack.svg" alt="Timbal Logo" class="themedComponent_mlkZ themedComponent--light_NVdE" height="auto" width="100px"><img src="/img/LogoWhite.svg" alt="Timbal Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU" height="auto" width="100px"></div></a><a class="navbar__item navbar__link" href="/introduction">Docs</a><a class="navbar__item navbar__link" href="/examples">Examples</a><a class="navbar__item navbar__link" href="/releases">Releases</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/timbal-ai/timbal" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/introduction">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/getting-started/installation">Getting Started</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/installation">Installation</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/quickstart">Quickstart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/getting-started/model_capabilities">Model Capabilities</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/agents">Agents</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/agents">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/agents/memory">Adding Memory</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/agents/rewind">Rewind</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/agents/tools">Tools</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/agents/voice">Voice</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/agents/evals">Evals</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/flows">Flows</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/flows">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/flows/memory">Using Memory</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/flows/advanced">Advanced Flow Concepts</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/state">State</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/state">Overview</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/integrations">Integrations</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/integrations">Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/integrations/elevenlabs">ElevenLabs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/integrations/perplexity">Perplexity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/integrations/twilio">Twilio</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/integrations/gmail">Gmail</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/integrations/sharepoint">SharePoint</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/integrations/fal">Fal</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Flows</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Overview</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Orchestrating AI Workflows</h1></header>
<h2 class="subtitle" style="margin-top:-17px;font-size:1.1rem;font-weight:normal"><p>Design, connect, and control multi-step AI pipelines using Flows—Timbal&#x27;s flexible workflow engine.</p></h2>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-are-flows">What Are Flows?<a href="#what-are-flows" class="hash-link" aria-label="Direct link to What Are Flows?" title="Direct link to What Are Flows?">​</a></h2>
<p>A <strong>Flow</strong> is a programmable pipeline that lets you chain together steps—functions, LLMs, or even other flows—while controlling how data moves between them. Flows enable you to build complex, intelligent workflows with clear logic, memory, and branching.</p>
<div class="custom-codeblock-container" style="border-radius:12px;overflow:hidden;border:1px solid #333;margin-bottom:1.5em;position:relative"><div style="position:relative"><button class="copy-icon-btn" aria-label="Copy code" type="button" style="position:absolute;top:12px;right:1em;z-index:10;background:rgba(30,30,30,0.7);border:none;border-radius:6px;padding:4px;cursor:pointer;pointer-events:auto;transition:opacity 0.2s, background 0.2s"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><g fill="none" stroke="#fff" stroke-width="1.5"><path d="M6 11c0-2.828 0-4.243.879-5.121C7.757 5 9.172 5 12 5h3c2.828 0 4.243 0 5.121.879C21 6.757 21 8.172 21 11v5c0 2.828 0 4.243-.879 5.121C19.243 22 17.828 22 15 22h-3c-2.828 0-4.243 0-5.121-.879C6 20.243 6 18.828 6 16z"></path><path d="M6 19a3 3 0 0 1-3-3v-6c0-3.771 0-5.657 1.172-6.828S7.229 2 11 2h4a3 3 0 0 1 3 3"></path></g></svg></button><pre class="prism-code language-python" style="color:#ffffff;background-color:#2d2d2d;border:none;border-radius:0;margin:0;position:relative"><div class="token-line" style="color:#ffffff"><span><span class="custom-highlight-pink">from</span></span><span> <span class="custom-highlight-green">timbal</span> </span><span><span class="custom-highlight-pink">import</span></span><span> <span class="custom-highlight-green">Flow</span></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">flow </span><span><span class="custom-highlight-pink">=</span></span><span> <span class="custom-highlight-green">Flow</span></span><span class="custom-highlight-yellow-dark">(</span><span><span class="custom-highlight-orange">id</span></span><span><span class="custom-highlight-pink">=</span></span><span><span class="custom-highlight-yellow">"my_flow"</span></span><span class="custom-highlight-yellow-dark">)</span><span style="display:inline-block;width:1em"></span></div></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="building-blocks-of-a-flow">Building Blocks of a Flow<a href="#building-blocks-of-a-flow" class="hash-link" aria-label="Direct link to Building Blocks of a Flow" title="Direct link to Building Blocks of a Flow">​</a></h2>
<div class="cards-container"><div class="card"><div class="card-content"><h3>Steps</h3><p></p><p><strong>Steps</strong> are the core units of work.</p><p>Each step can be:</p><ul>
<li>a function</li>
<li>a BaseStep</li>
<li>another flow.</li>
</ul><p>Steps process data, perform actions, and pass results onward.</p><p></p></div></div><div class="card"><div class="card-content"><h3>Links</h3><p></p><p><strong>Links</strong> define the order and dependencies between steps.</p><p>They control how data and execution flow from one step to another, and can be used for tool calls, tool results, and conditional branching.</p><p></p></div></div></div>
<div class="custom-codeblock-container" style="border-radius:12px;overflow:hidden;border:1px solid #333;margin-bottom:1.5em;position:relative"><div style="position:relative"><button class="copy-icon-btn" aria-label="Copy code" type="button" style="position:absolute;top:12px;right:1em;z-index:10;background:rgba(30,30,30,0.7);border:none;border-radius:6px;padding:4px;cursor:pointer;pointer-events:auto;transition:opacity 0.2s, background 0.2s"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><g fill="none" stroke="#fff" stroke-width="1.5"><path d="M6 11c0-2.828 0-4.243.879-5.121C7.757 5 9.172 5 12 5h3c2.828 0 4.243 0 5.121.879C21 6.757 21 8.172 21 11v5c0 2.828 0 4.243-.879 5.121C19.243 22 17.828 22 15 22h-3c-2.828 0-4.243 0-5.121-.879C6 20.243 6 18.828 6 16z"></path><path d="M6 19a3 3 0 0 1-3-3v-6c0-3.771 0-5.657 1.172-6.828S7.229 2 11 2h4a3 3 0 0 1 3 3"></path></g></svg></button><pre class="prism-code language-python" style="color:#ffffff;background-color:#2d2d2d;border:none;border-radius:0;margin:0;position:relative"><div class="token-line" style="color:#ffffff"><span class="token plain">flow </span><span><span class="custom-highlight-pink">=</span></span><span class="token plain"> </span><span class="custom-highlight-yellow-dark">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span>  <span class="custom-highlight-green">Flow</span></span><span style="color:#ff69b4">(</span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">add_step</span></span><span style="color:#ff69b4">(</span><span><span class="custom-highlight-yellow">"step_1"</span></span><span><span class="#fffff">,</span></span><span class="token plain"> handler_1</span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">add_step</span></span><span style="color:#ff69b4">(</span><span><span class="custom-highlight-yellow">"step_2"</span></span><span><span class="#fffff">,</span></span><span class="token plain"> handler_2</span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">add_link</span></span><span style="color:#ff69b4">(</span><span><span class="custom-highlight-yellow">"step_1"</span></span><span><span class="#fffff">,</span></span><span class="token plain"> </span><span><span class="custom-highlight-yellow">"step_2"</span></span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="custom-highlight-yellow-dark">)</span><span style="display:inline-block;width:1em"></span></div></pre></div></div>
<div style="text-align:center"><img src="/img/dag_link.png" style="width:20rem"></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="controlling-step-inputs">Controlling Step Inputs<a href="#controlling-step-inputs" class="hash-link" aria-label="Direct link to Controlling Step Inputs" title="Direct link to Controlling Step Inputs">​</a></h2>
<p>When building flows, you often need to control how each step receives its inputs. Timbal provides two powerful methods for this:</p>
<ul>
<li><strong>Data Maps</strong> (<code>set_data_map</code>): Dynamically connect a step&#x27;s input to the output of another step or a flow input.</li>
<li><strong>Data Values</strong> (<code>set_data_value</code>): Set a static value or template for a step&#x27;s input.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-maps">Data Maps<a href="#data-maps" class="hash-link" aria-label="Direct link to Data Maps" title="Direct link to Data Maps">​</a></h3>
<p><strong>Purpose:</strong>
Connect a step&#x27;s input parameter to the output of another step, or to a flow input.</p>
<p><strong>Syntax:</strong></p>
<div class="custom-codeblock-container" style="border-radius:12px;overflow:hidden;border:1px solid #333;margin-bottom:1.5em;position:relative"><div style="position:relative"><button class="copy-icon-btn" aria-label="Copy code" type="button" style="position:absolute;top:12px;right:1em;z-index:10;background:rgba(30,30,30,0.7);border:none;border-radius:6px;padding:4px;cursor:pointer;pointer-events:auto;transition:opacity 0.2s, background 0.2s"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><g fill="none" stroke="#fff" stroke-width="1.5"><path d="M6 11c0-2.828 0-4.243.879-5.121C7.757 5 9.172 5 12 5h3c2.828 0 4.243 0 5.121.879C21 6.757 21 8.172 21 11v5c0 2.828 0 4.243-.879 5.121C19.243 22 17.828 22 15 22h-3c-2.828 0-4.243 0-5.121-.879C6 20.243 6 18.828 6 16z"></path><path d="M6 19a3 3 0 0 1-3-3v-6c0-3.771 0-5.657 1.172-6.828S7.229 2 11 2h4a3 3 0 0 1 3 3"></path></g></svg></button><pre class="prism-code language-python" style="color:#ffffff;background-color:#2d2d2d;border:none;border-radius:0;margin:0;position:relative"><div class="token-line" style="color:#ffffff"><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">set_data_map</span></span><span class="custom-highlight-yellow-dark">(</span><span><span class="custom-highlight-yellow">"step_name.parameter"</span></span><span><span class="#fffff">,</span></span><span class="token plain"> </span><span><span class="custom-highlight-yellow">"source"</span></span><span class="custom-highlight-yellow-dark">)</span><span style="display:inline-block;width:1em"></span></div></pre></div></div>
<ul>
<li><code>step_name.parameter</code>: The input parameter of a step (e.g., <code>check.fahrenheit</code>).</li>
<li><code>source</code>: The data key to use as the value. This can be:<!-- -->
<ul>
<li>The output of another step (e.g., <code>to_fahrenheit.return</code>)</li>
<li>A flow input (e.g., <code>input_x</code>)</li>
</ul>
</li>
</ul>
<p><strong>Example:</strong></p>
<div class="custom-codeblock-container" style="border-radius:12px;overflow:hidden;border:1px solid #333;margin-bottom:1.5em;position:relative"><div style="position:relative"><button class="copy-icon-btn" aria-label="Copy code" type="button" style="position:absolute;top:12px;right:1em;z-index:10;background:rgba(30,30,30,0.7);border:none;border-radius:6px;padding:4px;cursor:pointer;pointer-events:auto;transition:opacity 0.2s, background 0.2s"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><g fill="none" stroke="#fff" stroke-width="1.5"><path d="M6 11c0-2.828 0-4.243.879-5.121C7.757 5 9.172 5 12 5h3c2.828 0 4.243 0 5.121.879C21 6.757 21 8.172 21 11v5c0 2.828 0 4.243-.879 5.121C19.243 22 17.828 22 15 22h-3c-2.828 0-4.243 0-5.121-.879C6 20.243 6 18.828 6 16z"></path><path d="M6 19a3 3 0 0 1-3-3v-6c0-3.771 0-5.657 1.172-6.828S7.229 2 11 2h4a3 3 0 0 1 3 3"></path></g></svg></button><pre class="prism-code language-python" style="color:#ffffff;background-color:#2d2d2d;border:none;border-radius:0;margin:0;position:relative"><div class="token-line" style="color:#ffffff"><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">set_data_map</span></span><span class="custom-highlight-yellow-dark">(</span><span><span class="custom-highlight-yellow">"to_fahrenheit.celsius"</span></span><span><span class="#fffff">,</span></span><span class="token plain"> </span><span><span class="custom-highlight-yellow">"get_temp.return"</span></span><span class="custom-highlight-yellow-dark">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">set_data_map</span></span><span class="custom-highlight-yellow-dark">(</span><span><span class="custom-highlight-yellow">"check.fahrenheit"</span></span><span><span class="#fffff">,</span></span><span class="token plain"> </span><span><span class="custom-highlight-yellow">"to_fahrenheit.return"</span></span><span class="custom-highlight-yellow-dark">)</span><span style="display:inline-block;width:1em"></span></div></pre></div></div>
<p>This means:</p>
<ul>
<li>The <code>celsius</code> parameter of the <code>to_fahrenheit</code> step receives the output of <code>get_temp</code>.</li>
<li>The <code>fahrenheit</code> parameter of the <code>check</code> step receives the output of <code>to_fahrenheit</code>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="data-values">Data Values<a href="#data-values" class="hash-link" aria-label="Direct link to Data Values" title="Direct link to Data Values">​</a></h3>
<p><strong>Purpose:</strong>
Set a static value or template for a step&#x27;s input.</p>
<p><strong>Syntax:</strong></p>
<div class="custom-codeblock-container" style="border-radius:12px;overflow:hidden;border:1px solid #333;margin-bottom:1.5em;position:relative"><div style="position:relative"><button class="copy-icon-btn" aria-label="Copy code" type="button" style="position:absolute;top:12px;right:1em;z-index:10;background:rgba(30,30,30,0.7);border:none;border-radius:6px;padding:4px;cursor:pointer;pointer-events:auto;transition:opacity 0.2s, background 0.2s"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><g fill="none" stroke="#fff" stroke-width="1.5"><path d="M6 11c0-2.828 0-4.243.879-5.121C7.757 5 9.172 5 12 5h3c2.828 0 4.243 0 5.121.879C21 6.757 21 8.172 21 11v5c0 2.828 0 4.243-.879 5.121C19.243 22 17.828 22 15 22h-3c-2.828 0-4.243 0-5.121-.879C6 20.243 6 18.828 6 16z"></path><path d="M6 19a3 3 0 0 1-3-3v-6c0-3.771 0-5.657 1.172-6.828S7.229 2 11 2h4a3 3 0 0 1 3 3"></path></g></svg></button><pre class="prism-code language-python" style="color:#ffffff;background-color:#2d2d2d;border:none;border-radius:0;margin:0;position:relative"><div class="token-line" style="color:#ffffff"><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">set_data_value</span></span><span class="custom-highlight-yellow-dark">(</span><span><span class="custom-highlight-yellow">"step_name.parameter"</span></span><span><span class="#fffff">,</span></span><span class="token plain"> value</span><span class="custom-highlight-yellow-dark">)</span><span style="display:inline-block;width:1em"></span></div></pre></div></div>
<ul>
<li><code>step_name.parameter</code>: The input parameter of a step (e.g., <code>check.threshold</code>).</li>
<li><code>value</code>: A constant (e.g., <code>86</code>), or a template string (e.g., <code>&quot;{{step_1.return}} and {{step_2.return}}&quot;</code>).</li>
</ul>
<p><strong>Example:</strong></p>
<div class="custom-codeblock-container" style="border-radius:12px;overflow:hidden;border:1px solid #333;margin-bottom:1.5em;position:relative"><div style="position:relative"><button class="copy-icon-btn" aria-label="Copy code" type="button" style="position:absolute;top:12px;right:1em;z-index:10;background:rgba(30,30,30,0.7);border:none;border-radius:6px;padding:4px;cursor:pointer;pointer-events:auto;transition:opacity 0.2s, background 0.2s"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><g fill="none" stroke="#fff" stroke-width="1.5"><path d="M6 11c0-2.828 0-4.243.879-5.121C7.757 5 9.172 5 12 5h3c2.828 0 4.243 0 5.121.879C21 6.757 21 8.172 21 11v5c0 2.828 0 4.243-.879 5.121C19.243 22 17.828 22 15 22h-3c-2.828 0-4.243 0-5.121-.879C6 20.243 6 18.828 6 16z"></path><path d="M6 19a3 3 0 0 1-3-3v-6c0-3.771 0-5.657 1.172-6.828S7.229 2 11 2h4a3 3 0 0 1 3 3"></path></g></svg></button><pre class="prism-code language-python" style="color:#ffffff;background-color:#2d2d2d;border:none;border-radius:0;margin:0;position:relative"><div class="token-line" style="color:#ffffff"><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">set_data_value</span></span><span class="custom-highlight-yellow-dark">(</span><span><span class="custom-highlight-yellow">"check.threshold"</span></span><span><span class="#fffff">,</span></span><span class="token plain"> </span><span class="token number" style="color:#36acaa">86</span><span class="custom-highlight-yellow-dark">)</span><span style="display:inline-block;width:1em"></span></div></pre></div></div>
<p>This means:</p>
<ul>
<li>The <code>threshold</code> parameter of the <code>check</code> step will always be set to <code>86</code>.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="inputs-and-outputs">Inputs and Outputs<a href="#inputs-and-outputs" class="hash-link" aria-label="Direct link to Inputs and Outputs" title="Direct link to Inputs and Outputs">​</a></h3>
<p><strong>Inputs</strong> and <strong>outputs</strong> in a flow are special cases of data mapping:</p>
<ul>
<li><strong>Inputs</strong>: Use <code>.set_input(&quot;step.parameter&quot;, &quot;input_name&quot;)</code> to specify that a step should receive its value from a flow input.</li>
<li><strong>Outputs</strong>: Use <code>.set_output(&quot;step.return&quot;, &quot;result_name&quot;)</code> to specify which step&#x27;s output is returned by the flow.</li>
</ul>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The output key will always be &quot;<strong>.return</strong>&quot; (e.g., &quot;to_fahrenheit.return&quot;), since it refers to the return value of the step.</p></div></div>
<p><strong>Example:</strong></p>
<div class="custom-codeblock-container" style="border-radius:12px;overflow:hidden;border:1px solid #333;margin-bottom:1.5em;position:relative"><div style="position:relative"><button class="copy-icon-btn" aria-label="Copy code" type="button" style="position:absolute;top:12px;right:1em;z-index:10;background:rgba(30,30,30,0.7);border:none;border-radius:6px;padding:4px;cursor:pointer;pointer-events:auto;transition:opacity 0.2s, background 0.2s"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><g fill="none" stroke="#fff" stroke-width="1.5"><path d="M6 11c0-2.828 0-4.243.879-5.121C7.757 5 9.172 5 12 5h3c2.828 0 4.243 0 5.121.879C21 6.757 21 8.172 21 11v5c0 2.828 0 4.243-.879 5.121C19.243 22 17.828 22 15 22h-3c-2.828 0-4.243 0-5.121-.879C6 20.243 6 18.828 6 16z"></path><path d="M6 19a3 3 0 0 1-3-3v-6c0-3.771 0-5.657 1.172-6.828S7.229 2 11 2h4a3 3 0 0 1 3 3"></path></g></svg></button><pre class="prism-code language-python" style="color:#ffffff;background-color:#2d2d2d;border:none;border-radius:0;margin:0;position:relative"><div class="token-line" style="color:#ffffff"><span class="token plain">flow </span><span><span class="custom-highlight-pink">=</span></span><span class="token plain"> </span><span class="custom-highlight-yellow-dark">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span>  <span class="custom-highlight-green">Flow</span></span><span style="color:#ff69b4">(</span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">add_step</span></span><span style="color:#ff69b4">(</span><span><span class="custom-highlight-yellow">"to_fahrenheit"</span></span><span><span class="#fffff">,</span></span><span> <span class="custom-highlight-green-fn">celsius_to_fahrenheit</span></span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">set_input</span></span><span style="color:#ff69b4">(</span><span><span class="custom-highlight-yellow">"to_fahrenheit.celsius"</span></span><span><span class="#fffff">,</span></span><span class="token plain"> </span><span><span class="custom-highlight-yellow">"input_celsius"</span></span><span style="color:#ff69b4">)</span><span class="token plain">  </span><span class="token comment" style="color:#999988;font-style:italic"># input_celsius is a flow input</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">set_output</span></span><span style="color:#ff69b4">(</span><span><span class="custom-highlight-yellow">"to_fahrenheit.return"</span></span><span><span class="#fffff">,</span></span><span class="token plain"> </span><span><span class="custom-highlight-yellow">"fahrenheit"</span></span><span style="color:#ff69b4">)</span><span class="token plain">   </span><span class="token comment" style="color:#999988;font-style:italic"># expose flow output</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="custom-highlight-yellow-dark">)</span><span style="display:inline-block;width:1em"></span></div></pre></div></div>
<p>This means:</p>
<ul>
<li>The flow expects an input called <code>input_celsius</code>.</li>
<li>The output of <code>to_fahrenheit</code> will be available as <code>fahrenheit</code> in the flow&#x27;s result.</li>
</ul>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="example-temperature-alert-flow">Example: Temperature Alert Flow<a href="#example-temperature-alert-flow" class="hash-link" aria-label="Direct link to Example: Temperature Alert Flow" title="Direct link to Example: Temperature Alert Flow">​</a></h3>
<div class="custom-codeblock-container" style="border-radius:12px;overflow:hidden;border:1px solid #333;margin-bottom:1.5em;position:relative"><div style="position:relative"><button class="copy-icon-btn" aria-label="Copy code" type="button" style="position:absolute;top:12px;right:1em;z-index:10;background:rgba(30,30,30,0.7);border:none;border-radius:6px;padding:4px;cursor:pointer;pointer-events:auto;transition:opacity 0.2s, background 0.2s"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><g fill="none" stroke="#fff" stroke-width="1.5"><path d="M6 11c0-2.828 0-4.243.879-5.121C7.757 5 9.172 5 12 5h3c2.828 0 4.243 0 5.121.879C21 6.757 21 8.172 21 11v5c0 2.828 0 4.243-.879 5.121C19.243 22 17.828 22 15 22h-3c-2.828 0-4.243 0-5.121-.879C6 20.243 6 18.828 6 16z"></path><path d="M6 19a3 3 0 0 1-3-3v-6c0-3.771 0-5.657 1.172-6.828S7.229 2 11 2h4a3 3 0 0 1 3 3"></path></g></svg></button><pre class="prism-code language-python" style="color:#ffffff;background-color:#2d2d2d;border:none;border-radius:0;margin:0;position:relative"><div class="token-line" style="color:#ffffff"><span><span class="custom-highlight-pink">from</span></span><span> <span class="custom-highlight-green">timbal</span> </span><span><span class="custom-highlight-pink">import</span></span><span> <span class="custom-highlight-green">Flow</span></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span><span class="custom-highlight-blue">def</span></span><span class="token plain"> </span><span><span class="custom-highlight-green-fn">celsius_to_fahrenheit</span></span><span class="custom-highlight-yellow-dark">(</span><span><span class="custom-highlight-orange">celsius</span></span><span class="custom-highlight-yellow-dark">)</span><span><span class="#fffff">:</span></span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="custom-highlight-pink">return</span></span><span> <span class="custom-highlight-orange">celsius</span> </span><span><span class="custom-highlight-pink">*</span></span><span class="token plain"> </span><span class="token number" style="color:#36acaa">9</span><span class="token plain"> </span><span><span class="custom-highlight-pink">/</span></span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5</span><span class="token plain"> </span><span><span class="custom-highlight-pink">+</span></span><span class="token plain"> </span><span class="token number" style="color:#36acaa">32</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span><span class="custom-highlight-blue">def</span></span><span class="token plain"> </span><span><span class="custom-highlight-green-fn">check_threshold</span></span><span class="custom-highlight-yellow-dark">(</span><span><span class="custom-highlight-orange">fahrenheit</span></span><span><span class="#fffff">,</span></span><span> <span class="custom-highlight-orange">threshold</span></span><span class="custom-highlight-yellow-dark">)</span><span><span class="#fffff">:</span></span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="custom-highlight-pink">if</span></span><span> <span class="custom-highlight-orange">fahrenheit</span> </span><span><span class="#fffff">></span></span><span> <span class="custom-highlight-orange">threshold</span></span><span><span class="#fffff">:</span></span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">      </span><span><span class="custom-highlight-pink">return</span></span><span class="token plain"> </span><span><span class="custom-highlight-yellow">"Alert: Temperature is too high!"</span></span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="custom-highlight-pink">else</span></span><span><span class="#fffff">:</span></span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">      </span><span><span class="custom-highlight-pink">return</span></span><span class="token plain"> </span><span><span class="custom-highlight-yellow">"Temperature is normal."</span></span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">flow </span><span><span class="custom-highlight-pink">=</span></span><span class="token plain"> </span><span class="custom-highlight-yellow-dark">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span>  <span class="custom-highlight-green">Flow</span></span><span style="color:#ff69b4">(</span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">add_step</span></span><span style="color:#ff69b4">(</span><span><span class="custom-highlight-yellow">"to_fahrenheit"</span></span><span><span class="#fffff">,</span></span><span> <span class="custom-highlight-green-fn">celsius_to_fahrenheit</span></span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">add_step</span></span><span style="color:#ff69b4">(</span><span><span class="custom-highlight-yellow">"check"</span></span><span><span class="#fffff">,</span></span><span> <span class="custom-highlight-green-fn">check_threshold</span></span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="custom-highlight-comment">  </span><span class="custom-highlight-comment"># Map Celsius input parameter to the function</span><span class="custom-highlight-comment"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">set_input</span></span><span style="color:#ff69b4">(</span><span><span class="custom-highlight-yellow">"to_fahrenheit.celsius"</span></span><span><span class="#fffff">,</span></span><span class="token plain"> </span><span><span class="custom-highlight-yellow">"input_celsius"</span></span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="custom-highlight-comment">  </span><span class="custom-highlight-comment"># Map Fahrenheit output to threshold checker</span><span class="custom-highlight-comment"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">set_data_map</span></span><span style="color:#ff69b4">(</span><span><span class="custom-highlight-yellow">"check.fahrenheit"</span></span><span><span class="#fffff">,</span></span><span class="token plain"> </span><span><span class="custom-highlight-yellow">"to_fahrenheit.return"</span></span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="custom-highlight-comment">  </span><span class="custom-highlight-comment"># Set a static threshold value</span><span class="custom-highlight-comment"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">set_data_value</span></span><span style="color:#ff69b4">(</span><span><span class="custom-highlight-yellow">"check.threshold"</span></span><span><span class="#fffff">,</span></span><span class="token plain"> </span><span class="token number" style="color:#36acaa">86</span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">set_output</span></span><span style="color:#ff69b4">(</span><span><span class="custom-highlight-yellow">"check.return"</span></span><span><span class="#fffff">,</span></span><span class="token plain"> </span><span><span class="custom-highlight-yellow">"status"</span></span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="custom-highlight-yellow-dark">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span><span class="custom-highlight-blue">async</span></span><span class="token plain"> </span><span><span class="custom-highlight-blue">def</span></span><span class="token plain"> </span><span><span class="custom-highlight-green-fn">main</span></span><span class="custom-highlight-yellow-dark">(</span><span class="custom-highlight-yellow-dark">)</span><span><span class="#fffff">:</span></span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  result </span><span><span class="custom-highlight-pink">=</span></span><span class="token plain"> </span><span><span class="custom-highlight-pink">await</span></span><span class="token plain"> flow</span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">complete</span></span><span class="custom-highlight-yellow-dark">(</span><span class="token plain">input_celsius</span><span><span class="custom-highlight-pink">=</span></span><span class="token number" style="color:#36acaa">35</span><span class="custom-highlight-yellow-dark">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="custom-highlight-green-fn">print</span></span><span class="custom-highlight-yellow-dark">(</span><span class="token plain">result</span><span><span class="#fffff">.</span></span><span class="token plain">output</span><span style="color:#ff69b4">[</span><span><span class="custom-highlight-yellow">"status"</span></span><span style="color:#ff69b4">]</span><span class="custom-highlight-yellow-dark">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span><span style="display:inline-block;width:1em"></span></div></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="dynamic-data-with-string-interpolation">Dynamic Data with String Interpolation<a href="#dynamic-data-with-string-interpolation" class="hash-link" aria-label="Direct link to Dynamic Data with String Interpolation" title="Direct link to Dynamic Data with String Interpolation">​</a></h2>
<p>Template strings let you combine and transform outputs from multiple steps.<br>
<!-- -->This is especially useful for LLM prompts or merging results.</p>
<div class="custom-codeblock-container" style="border-radius:12px;overflow:hidden;border:1px solid #333;margin-bottom:1.5em;position:relative"><div style="position:relative"><button class="copy-icon-btn" aria-label="Copy code" type="button" style="position:absolute;top:12px;right:1em;z-index:10;background:rgba(30,30,30,0.7);border:none;border-radius:6px;padding:4px;cursor:pointer;pointer-events:auto;transition:opacity 0.2s, background 0.2s"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><g fill="none" stroke="#fff" stroke-width="1.5"><path d="M6 11c0-2.828 0-4.243.879-5.121C7.757 5 9.172 5 12 5h3c2.828 0 4.243 0 5.121.879C21 6.757 21 8.172 21 11v5c0 2.828 0 4.243-.879 5.121C19.243 22 17.828 22 15 22h-3c-2.828 0-4.243 0-5.121-.879C6 20.243 6 18.828 6 16z"></path><path d="M6 19a3 3 0 0 1-3-3v-6c0-3.771 0-5.657 1.172-6.828S7.229 2 11 2h4a3 3 0 0 1 3 3"></path></g></svg></button><pre class="prism-code language-python" style="color:#ffffff;background-color:#2d2d2d;border:none;border-radius:0;margin:0;position:relative"><div class="token-line" style="color:#ffffff"><span><span class="custom-highlight-pink">from</span></span><span> <span class="custom-highlight-green">timbal</span> </span><span><span class="custom-highlight-pink">import</span></span><span> <span class="custom-highlight-green">Flow</span></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span><span class="custom-highlight-blue">def</span></span><span class="token plain"> </span><span><span class="custom-highlight-green-fn">get_first_name</span></span><span class="custom-highlight-yellow-dark">(</span><span class="custom-highlight-yellow-dark">)</span><span><span class="#fffff">:</span></span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="custom-highlight-pink">return</span></span><span class="token plain"> </span><span><span class="custom-highlight-yellow">"Alice"</span></span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span><span class="custom-highlight-blue">def</span></span><span class="token plain"> </span><span><span class="custom-highlight-green-fn">get_last_name</span></span><span class="custom-highlight-yellow-dark">(</span><span class="custom-highlight-yellow-dark">)</span><span><span class="#fffff">:</span></span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="custom-highlight-pink">return</span></span><span class="token plain"> </span><span><span class="custom-highlight-yellow">"Smith"</span></span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span><span class="custom-highlight-blue">def</span></span><span class="token plain"> </span><span><span class="custom-highlight-green-fn">check_full_name</span></span><span class="custom-highlight-yellow-dark">(</span><span><span class="custom-highlight-orange">full_name</span></span><span class="custom-highlight-yellow-dark">)</span><span><span class="#fffff">:</span></span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="custom-highlight-pink">if</span></span><span> <span class="custom-highlight-orange">full_name</span> </span><span><span class="custom-highlight-pink">=</span><span class="custom-highlight-pink">=</span></span><span class="token plain"> </span><span><span class="custom-highlight-yellow">"Alice Smith"</span></span><span><span class="#fffff">:</span></span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">      </span><span><span class="custom-highlight-pink">return</span></span><span class="token plain"> </span><span><span class="custom-highlight-yellow">"Welcome, Alice Smith!"</span></span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="custom-highlight-pink">else</span></span><span><span class="#fffff">:</span></span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">      </span><span><span class="custom-highlight-pink">return</span></span><span class="token plain"> </span><span class="token string-interpolation string" style="color:#e3116c">f&quot;User </span><span class="custom-highlight-yellow-dark">{</span><span><span class="custom-highlight-orange">full_name</span></span><span class="custom-highlight-yellow-dark">}</span><span> not recognized<span class="#fffff">.</span>"</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">flow </span><span><span class="custom-highlight-pink">=</span></span><span class="token plain"> </span><span class="custom-highlight-yellow-dark">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span>  <span class="custom-highlight-green">Flow</span></span><span style="color:#ff69b4">(</span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">add_step</span></span><span style="color:#ff69b4">(</span><span><span class="custom-highlight-yellow">"first_name"</span></span><span><span class="#fffff">,</span></span><span> <span class="custom-highlight-green-fn">get_first_name</span></span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">add_step</span></span><span style="color:#ff69b4">(</span><span><span class="custom-highlight-yellow">"last_name"</span></span><span><span class="#fffff">,</span></span><span> <span class="custom-highlight-green-fn">get_last_name</span></span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">add_step</span></span><span style="color:#ff69b4">(</span><span><span class="custom-highlight-yellow">"validate"</span></span><span><span class="#fffff">,</span></span><span> <span class="custom-highlight-green-fn">check_full_name</span></span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="custom-highlight-comment">  </span><span class="custom-highlight-comment"># Interpolate the outputs of first_name and last_name into a full name string</span><span class="custom-highlight-comment"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">set_data_value</span></span><span style="color:#ff69b4">(</span><span><span class="custom-highlight-yellow">"validate.full_name"</span></span><span><span class="#fffff">,</span></span><span class="token plain"> </span><span><span class="custom-highlight-yellow">"{{first_name.return}} {{last_name.return}}"</span></span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">set_output</span></span><span style="color:#ff69b4">(</span><span><span class="custom-highlight-yellow">"validate.return"</span></span><span><span class="#fffff">,</span></span><span class="token plain"> </span><span><span class="custom-highlight-yellow">"message"</span></span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="custom-highlight-yellow-dark">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span><span class="custom-highlight-blue">async</span></span><span class="token plain"> </span><span><span class="custom-highlight-blue">def</span></span><span class="token plain"> </span><span><span class="custom-highlight-green-fn">main</span></span><span class="custom-highlight-yellow-dark">(</span><span class="custom-highlight-yellow-dark">)</span><span><span class="#fffff">:</span></span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  result </span><span><span class="custom-highlight-pink">=</span></span><span class="token plain"> </span><span><span class="custom-highlight-pink">await</span></span><span class="token plain"> flow</span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">complete</span></span><span class="custom-highlight-yellow-dark">(</span><span class="custom-highlight-yellow-dark">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="custom-highlight-green-fn">print</span></span><span class="custom-highlight-yellow-dark">(</span><span class="token plain">result</span><span><span class="#fffff">.</span></span><span class="token plain">output</span><span style="color:#ff69b4">[</span><span><span class="custom-highlight-yellow">"message"</span></span><span style="color:#ff69b4">]</span><span class="custom-highlight-yellow-dark">)</span><span style="display:inline-block;width:1em"></span></div></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="integrating-llms">Integrating LLMs<a href="#integrating-llms" class="hash-link" aria-label="Direct link to Integrating LLMs" title="Direct link to Integrating LLMs">​</a></h2>
<p>You can add LLMs (Large Language Models) as steps in your flow using .add_llm().
LLMs can use memory, call tools, and be chained with other steps for advanced reasoning.</p>
<ul>
<li><strong>Memory</strong>: Use the memory_id parameter to enable persistent context across runs.</li>
<li><strong>Tool Use</strong>: Connect LLMs to tools or functions using .add_link(..., is_tool=True) and .add_link(..., is_tool_result=True) for advanced workflows.</li>
<li><strong>Prompt Construction</strong>: Use string interpolation to dynamically build prompts from previous step outputs.</li>
</ul>
<p>Suppose you want to fetch an email, then have an LLM summarize it:</p>
<div class="custom-codeblock-container" style="border-radius:12px;overflow:hidden;border:1px solid #333;margin-bottom:1.5em;position:relative"><div style="position:relative"><button class="copy-icon-btn" aria-label="Copy code" type="button" style="position:absolute;top:12px;right:1em;z-index:10;background:rgba(30,30,30,0.7);border:none;border-radius:6px;padding:4px;cursor:pointer;pointer-events:auto;transition:opacity 0.2s, background 0.2s"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><g fill="none" stroke="#fff" stroke-width="1.5"><path d="M6 11c0-2.828 0-4.243.879-5.121C7.757 5 9.172 5 12 5h3c2.828 0 4.243 0 5.121.879C21 6.757 21 8.172 21 11v5c0 2.828 0 4.243-.879 5.121C19.243 22 17.828 22 15 22h-3c-2.828 0-4.243 0-5.121-.879C6 20.243 6 18.828 6 16z"></path><path d="M6 19a3 3 0 0 1-3-3v-6c0-3.771 0-5.657 1.172-6.828S7.229 2 11 2h4a3 3 0 0 1 3 3"></path></g></svg></button><pre class="prism-code language-python" style="color:#ffffff;background-color:#2d2d2d;border:none;border-radius:0;margin:0;position:relative"><div class="token-line" style="color:#ffffff"><span><span class="custom-highlight-pink">from</span></span><span> <span class="custom-highlight-green">timbal</span> </span><span><span class="custom-highlight-pink">import</span></span><span> <span class="custom-highlight-green">Flow</span></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span><span class="custom-highlight-blue">def</span></span><span class="token plain"> </span><span class="token function" style="color:#d73a49">get_email</span><span class="custom-highlight-yellow-dark">(</span><span class="custom-highlight-yellow-dark">)</span><span><span class="#fffff">:</span></span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="custom-highlight-pink">return</span></span><span class="token plain"> </span><span><span class="custom-highlight-yellow">"Hi team, let's meet tomorrow at 10am to discuss the project. Best, Alice"</span></span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">flow </span><span><span class="custom-highlight-pink">=</span></span><span class="token plain"> </span><span class="custom-highlight-yellow-dark">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span>  <span class="custom-highlight-green">Flow</span></span><span style="color:#ff69b4">(</span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">add_step</span></span><span style="color:#ff69b4">(</span><span><span class="custom-highlight-yellow">"fetch_email"</span></span><span><span class="#fffff">,</span></span><span class="token plain"> get_email</span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">add_llm</span></span><span style="color:#ff69b4">(</span><span><span class="custom-highlight-yellow">"llm"</span></span><span><span class="#fffff">,</span></span><span> <span class="custom-highlight-orange">model</span></span><span><span class="custom-highlight-pink">=</span></span><span><span class="custom-highlight-yellow">"gpt-4o-mini"</span></span><span><span class="#fffff">,</span></span><span> <span class="custom-highlight-orange">memory_id</span></span><span><span class="custom-highlight-pink">=</span></span><span><span class="custom-highlight-yellow">"persistent_memory"</span></span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="custom-highlight-comment">  </span><span class="custom-highlight-comment"># Use string interpolation to build the prompt from the previous step</span><span class="custom-highlight-comment"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">set_data_value</span></span><span style="color:#ff69b4">(</span><span><span class="custom-highlight-yellow">"llm.prompt"</span></span><span><span class="#fffff">,</span></span><span class="token plain"> </span><span><span class="custom-highlight-yellow">"Summarize this email: {{fetch_email.return}}"</span></span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">set_output</span></span><span style="color:#ff69b4">(</span><span><span class="custom-highlight-yellow">"llm.return"</span></span><span><span class="#fffff">,</span></span><span class="token plain"> </span><span><span class="custom-highlight-yellow">"summary"</span></span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="custom-highlight-yellow-dark">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span><span class="custom-highlight-blue">async</span></span><span class="token plain"> </span><span><span class="custom-highlight-blue">def</span></span><span class="token plain"> </span><span><span class="custom-highlight-green-fn">main</span></span><span class="custom-highlight-yellow-dark">(</span><span class="custom-highlight-yellow-dark">)</span><span><span class="#fffff">:</span></span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  result </span><span><span class="custom-highlight-pink">=</span></span><span class="token plain"> </span><span><span class="custom-highlight-pink">await</span></span><span class="token plain"> flow</span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">complete</span></span><span class="custom-highlight-yellow-dark">(</span><span class="custom-highlight-yellow-dark">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="custom-highlight-green-fn">print</span></span><span class="custom-highlight-yellow-dark">(</span><span class="token plain">result</span><span><span class="#fffff">.</span></span><span class="token plain">output</span><span style="color:#ff69b4">[</span><span><span class="custom-highlight-yellow">"summary"</span></span><span style="color:#ff69b4">]</span><span><span class="#fffff">.</span></span><span class="token plain">content</span><span style="color:#ff69b4">[</span><span class="token number" style="color:#36acaa">0</span><span style="color:#ff69b4">]</span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-orange">text</span></span><span class="custom-highlight-yellow-dark">)</span><span style="display:inline-block;width:1em"></span></div></pre></div></div>
<p><strong>What’s happening here?</strong>*</p>
<ul>
<li><code>fetch_email</code> retrieves the email text.</li>
<li>The LLM step receives a prompt that includes the email content.</li>
<li>The LLM generates a summary, which is returned as the flow output.</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>You can chain multiple steps, use memory for context, and connect LLMs to external tools for even more powerful workflows.</p></div></div>
<p>For more, see the <a href="/flows/advanced">Advanced documentation</a></p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="enabling-memory-and-finalizing-your-flow">Enabling Memory and Finalizing Your Flow<a href="#enabling-memory-and-finalizing-your-flow" class="hash-link" aria-label="Direct link to Enabling Memory and Finalizing Your Flow" title="Direct link to Enabling Memory and Finalizing Your Flow">​</a></h2>
<p>To enable advanced features like persistent memory, you need to finalize your flow using the .compile() method.</p>
<p>Compiling your flow validates its structure and (optionally) attaches a state saver for memory.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="why-compile">Why compile?<a href="#why-compile" class="hash-link" aria-label="Direct link to Why compile?" title="Direct link to Why compile?">​</a></h3>
<p>Compiling ensures your flow is ready for production, with all steps, data maps, and memory configured correctly.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-enable-memory">How to enable memory?<a href="#how-to-enable-memory" class="hash-link" aria-label="Direct link to How to enable memory?" title="Direct link to How to enable memory?">​</a></h3>
<p>Pass a state saver (like InMemorySaver) to .compile() to persist context across runs.</p>
<p>See <a href="/state">State Savers</a> for more information.</p>
<div class="custom-codeblock-container" style="border-radius:12px;overflow:hidden;border:1px solid #333;margin-bottom:1.5em;position:relative"><div style="position:relative"><button class="copy-icon-btn" aria-label="Copy code" type="button" style="position:absolute;top:12px;right:1em;z-index:10;background:rgba(30,30,30,0.7);border:none;border-radius:6px;padding:4px;cursor:pointer;pointer-events:auto;transition:opacity 0.2s, background 0.2s"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><g fill="none" stroke="#fff" stroke-width="1.5"><path d="M6 11c0-2.828 0-4.243.879-5.121C7.757 5 9.172 5 12 5h3c2.828 0 4.243 0 5.121.879C21 6.757 21 8.172 21 11v5c0 2.828 0 4.243-.879 5.121C19.243 22 17.828 22 15 22h-3c-2.828 0-4.243 0-5.121-.879C6 20.243 6 18.828 6 16z"></path><path d="M6 19a3 3 0 0 1-3-3v-6c0-3.771 0-5.657 1.172-6.828S7.229 2 11 2h4a3 3 0 0 1 3 3"></path></g></svg></button><pre class="prism-code language-python" style="color:#ffffff;background-color:#2d2d2d;border:none;border-radius:0;margin:0;position:relative"><div class="token-line" style="color:#ffffff"><span><span class="custom-highlight-pink">from</span></span><span> <span class="custom-highlight-green">timbal</span></span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green">state</span></span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green">savers</span> </span><span><span class="custom-highlight-pink">import</span></span><span> <span class="custom-highlight-green">InMemorySaver</span></span></div><div class="token-line" style="color:#ffffff"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#ffffff"><span class="token plain">flow </span><span><span class="custom-highlight-pink">=</span></span><span class="token plain"> </span><span class="custom-highlight-yellow-dark">(</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span>  <span class="custom-highlight-green">Flow</span></span><span style="color:#ff69b4">(</span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">add_llm</span></span><span style="color:#ff69b4">(</span><span><span class="custom-highlight-orange">memory_id</span></span><span><span class="custom-highlight-pink">=</span></span><span><span class="custom-highlight-yellow">"persistent_memory"</span></span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">compile</span></span><span style="color:#ff69b4">(</span><span class="custom-highlight-orange">state_saver</span><span><span class="custom-highlight-pink">=</span></span><span><span class="custom-highlight-green">InMemorySaver</span></span><span style="color:#42a5f5">(</span><span style="color:#42a5f5">)</span><span style="color:#ff69b4">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span class="custom-highlight-yellow-dark">)</span><span style="display:inline-block;width:1em"></span></div></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-run-your-flow">How to Run Your Flow<a href="#how-to-run-your-flow" class="hash-link" aria-label="Direct link to How to Run Your Flow" title="Direct link to How to Run Your Flow">​</a></h2>
<p>Once your flow is defined and compiled, you can execute it in two main ways:</p>
<p><strong>Get the final output:</strong></p>
<div class="custom-codeblock-container" style="border-radius:12px;overflow:hidden;border:1px solid #333;margin-bottom:1.5em;position:relative"><div style="position:relative"><button class="copy-icon-btn" aria-label="Copy code" type="button" style="position:absolute;top:12px;right:1em;z-index:10;background:rgba(30,30,30,0.7);border:none;border-radius:6px;padding:4px;cursor:pointer;pointer-events:auto;transition:opacity 0.2s, background 0.2s"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><g fill="none" stroke="#fff" stroke-width="1.5"><path d="M6 11c0-2.828 0-4.243.879-5.121C7.757 5 9.172 5 12 5h3c2.828 0 4.243 0 5.121.879C21 6.757 21 8.172 21 11v5c0 2.828 0 4.243-.879 5.121C19.243 22 17.828 22 15 22h-3c-2.828 0-4.243 0-5.121-.879C6 20.243 6 18.828 6 16z"></path><path d="M6 19a3 3 0 0 1-3-3v-6c0-3.771 0-5.657 1.172-6.828S7.229 2 11 2h4a3 3 0 0 1 3 3"></path></g></svg></button><pre class="prism-code language-python" style="color:#ffffff;background-color:#2d2d2d;border:none;border-radius:0;margin:0;position:relative"><div class="token-line" style="color:#ffffff"><span class="token plain">result </span><span><span class="custom-highlight-pink">=</span></span><span class="token plain"> </span><span><span class="custom-highlight-pink">await</span></span><span class="token plain"> flow</span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">complete</span></span><span class="custom-highlight-yellow-dark">(</span><span class="token plain">input_x</span><span><span class="custom-highlight-pink">=</span></span><span class="token number" style="color:#36acaa">123</span><span class="custom-highlight-yellow-dark">)</span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain"></span><span><span class="custom-highlight-green-fn">print</span></span><span class="custom-highlight-yellow-dark">(</span><span class="token plain">result</span><span><span class="#fffff">.</span></span><span class="token plain">output</span><span style="color:#ff69b4">[</span><span><span class="custom-highlight-yellow">"result"</span></span><span style="color:#ff69b4">]</span><span class="custom-highlight-yellow-dark">)</span><span style="display:inline-block;width:1em"></span></div></pre></div></div>
<p><strong>Stream events as they happen:</strong></p>
<div class="custom-codeblock-container" style="border-radius:12px;overflow:hidden;border:1px solid #333;margin-bottom:1.5em;position:relative"><div style="position:relative"><button class="copy-icon-btn" aria-label="Copy code" type="button" style="position:absolute;top:12px;right:1em;z-index:10;background:rgba(30,30,30,0.7);border:none;border-radius:6px;padding:4px;cursor:pointer;pointer-events:auto;transition:opacity 0.2s, background 0.2s"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24"><g fill="none" stroke="#fff" stroke-width="1.5"><path d="M6 11c0-2.828 0-4.243.879-5.121C7.757 5 9.172 5 12 5h3c2.828 0 4.243 0 5.121.879C21 6.757 21 8.172 21 11v5c0 2.828 0 4.243-.879 5.121C19.243 22 17.828 22 15 22h-3c-2.828 0-4.243 0-5.121-.879C6 20.243 6 18.828 6 16z"></path><path d="M6 19a3 3 0 0 1-3-3v-6c0-3.771 0-5.657 1.172-6.828S7.229 2 11 2h4a3 3 0 0 1 3 3"></path></g></svg></button><pre class="prism-code language-python" style="color:#ffffff;background-color:#2d2d2d;border:none;border-radius:0;margin:0;position:relative"><div class="token-line" style="color:#ffffff"><span><span class="custom-highlight-blue">async</span></span><span class="token plain"> </span><span><span class="custom-highlight-pink">for</span></span><span class="token plain"> event </span><span><span class="custom-highlight-pink">in</span></span><span class="token plain"> flow</span><span><span class="#fffff">.</span></span><span><span class="custom-highlight-green-fn">run</span></span><span class="custom-highlight-yellow-dark">(</span><span class="token plain">input_x</span><span><span class="custom-highlight-pink">=</span></span><span class="token number" style="color:#36acaa">123</span><span class="custom-highlight-yellow-dark">)</span><span><span class="#fffff">:</span></span><span class="token plain"></span></div><div class="token-line" style="color:#ffffff"><span class="token plain">  </span><span><span class="custom-highlight-green-fn">print</span></span><span class="custom-highlight-yellow-dark">(</span><span class="token plain">event</span><span class="custom-highlight-yellow-dark">)</span><span style="display:inline-block;width:1em"></span></div></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="quick-reference">Quick Reference<a href="#quick-reference" class="hash-link" aria-label="Direct link to Quick Reference" title="Direct link to Quick Reference">​</a></h2>
<ul>
<li><strong>Steps</strong>: Units of work (functions, LLMs, or flows)</li>
<li><strong>Links</strong>: Control execution and data flow</li>
<li><strong>Data Maps/Values</strong>: Connect and set step inputs</li>
<li><strong>String Interpolation</strong>: Combine outputs flexibly</li>
<li><strong>LLMs</strong>: Add language models as steps</li>
<li><strong>Inputs/Outputs</strong>: Define what goes in and out of your flow</li>
<li><strong>compile()</strong>: Finalize and enable memory/state</li>
</ul>
<p>For more, see the <a href="/flows">Flows documentation</a>, <a href="/flows/advanced">Advanced Flow Concepts</a>, and <a href="/examples">Examples</a>.</p>
<style>
.cards-container {
display: flex;
gap: 1rem;
margin: 1rem 0;
flex-wrap: wrap;
}

.card {
flex: 1;
min-width: 300px;
background: var(--ifm-background-color);
border-radius: 8px;
box-shadow: 0 2px 4px rgba(0,0,0,0.1);
overflow: hidden;
}

.card-content {
padding: 1.5rem;
}

.card-content h3 {
color: var(--ifm-color-primary);
margin-top: 0;
margin-bottom: 1rem;
}

[data-theme='dark'] .card-content h3 {
color: #9d7cff;
}

.card-content ul {
list-style: disc;
padding-left: 1.2em;
margin: 0;
}

.card-content li {
margin: 0.5rem 0;
}

.capabilities {
display: flex;
flex-direction: column;
gap: 1.5rem;
margin: 2rem 0;
}

.capability {
display: flex;
align-items: flex-start;
gap: 1.5rem;
padding: 1.5rem;
background: var(--ifm-background-color);
border-radius: 8px;
box-shadow: 0 2px 4px rgba(0,0,0,0.1);
}

.capability-icon {
font-size: 2rem;
line-height: 1;
flex-shrink: 0;
}

.capability-content {
flex: 1;
}

.capability-content h3 {
color: var(--ifm-font-color-base);
margin-top: 0;
margin-bottom: 0.5rem;
}

.capability-content p {
margin: 0;
line-height: 1.5;
}
</style></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/agents/evals"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Evals</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/flows/memory"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Using Memory</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#what-are-flows" class="table-of-contents__link toc-highlight">What Are Flows?</a></li><li><a href="#building-blocks-of-a-flow" class="table-of-contents__link toc-highlight">Building Blocks of a Flow</a></li><li><a href="#controlling-step-inputs" class="table-of-contents__link toc-highlight">Controlling Step Inputs</a><ul><li><a href="#data-maps" class="table-of-contents__link toc-highlight">Data Maps</a></li><li><a href="#data-values" class="table-of-contents__link toc-highlight">Data Values</a></li><li><a href="#inputs-and-outputs" class="table-of-contents__link toc-highlight">Inputs and Outputs</a></li><li><a href="#example-temperature-alert-flow" class="table-of-contents__link toc-highlight">Example: Temperature Alert Flow</a></li></ul></li><li><a href="#dynamic-data-with-string-interpolation" class="table-of-contents__link toc-highlight">Dynamic Data with String Interpolation</a></li><li><a href="#integrating-llms" class="table-of-contents__link toc-highlight">Integrating LLMs</a></li><li><a href="#enabling-memory-and-finalizing-your-flow" class="table-of-contents__link toc-highlight">Enabling Memory and Finalizing Your Flow</a><ul><li><a href="#why-compile" class="table-of-contents__link toc-highlight">Why compile?</a></li><li><a href="#how-to-enable-memory" class="table-of-contents__link toc-highlight">How to enable memory?</a></li></ul></li><li><a href="#how-to-run-your-flow" class="table-of-contents__link toc-highlight">How to Run Your Flow</a></li><li><a href="#quick-reference" class="table-of-contents__link toc-highlight">Quick Reference</a></li></ul></div></div></div></div></main></div></div></div><footer class="custom-footer"><div class="social-icons"><a href="https://timbal.ai" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="globe" class="svg-inline--fa fa-globe" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentColor" d="M352 256c0 22.2-1.2 43.6-3.3 64l-185.3 0c-2.2-20.4-3.3-41.8-3.3-64s1.2-43.6 3.3-64l185.3 0c2.2 20.4 3.3 41.8 3.3 64zm28.8-64l123.1 0c5.3 20.5 8.1 41.9 8.1 64s-2.8 43.5-8.1 64l-123.1 0c2.1-20.6 3.2-42 3.2-64s-1.1-43.4-3.2-64zm112.6-32l-116.7 0c-10-63.9-29.8-117.4-55.3-151.6c78.3 20.7 142 77.5 171.9 151.6zm-149.1 0l-176.6 0c6.1-36.4 15.5-68.6 27-94.7c10.5-23.6 22.2-40.7 33.5-51.5C239.4 3.2 248.7 0 256 0s16.6 3.2 27.8 13.8c11.3 10.8 23 27.9 33.5 51.5c11.6 26 20.9 58.2 27 94.7zm-209 0L18.6 160C48.6 85.9 112.2 29.1 190.6 8.4C165.1 42.6 145.3 96.1 135.3 160zM8.1 192l123.1 0c-2.1 20.6-3.2 42-3.2 64s1.1 43.4 3.2 64L8.1 320C2.8 299.5 0 278.1 0 256s2.8-43.5 8.1-64zM194.7 446.6c-11.6-26-20.9-58.2-27-94.6l176.6 0c-6.1 36.4-15.5 68.6-27 94.6c-10.5 23.6-22.2 40.7-33.5 51.5C272.6 508.8 263.3 512 256 512s-16.6-3.2-27.8-13.8c-11.3-10.8-23-27.9-33.5-51.5zM135.3 352c10 63.9 29.8 117.4 55.3 151.6C112.2 482.9 48.6 426.1 18.6 352l116.7 0zm358.1 0c-30 74.1-93.6 130.9-171.9 151.6c25.5-34.2 45.2-87.7 55.3-151.6l116.7 0z"></path></svg></a><a href="https://github.com/timbal-ai/timbal" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentColor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a><a href="https://www.linkedin.com/company/timbal-ai/" target="_blank" rel="noopener noreferrer"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="linkedin" class="svg-inline--fa fa-linkedin" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentColor" d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a></div></footer></div>
</body>
</html>